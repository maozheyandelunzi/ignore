<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0054)http://www.ruanyifeng.com/blog/2014/10/event-loop.html -->
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
<meta name="generator" content="Movable Type  5.2.2">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/styles.css" type="text/css">
<link rel="start" href="http://www.ruanyifeng.com/blog/" title="Home">
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://feeds.feedburner.com/ruanyifeng">
<script async="" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/analytics.js.下载"></script><script type="text/javascript" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/mt.js.下载"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="http://www.ruanyifeng.com/blog/2012/10/javascript_module.html">
<dc:title>Javascript模块化编程（一）：模块的写法</dc:title>
<dc:description>随着网站逐渐变成&quot;互联网应用程序&quot;，嵌入网页的Javascript代码越来越庞大，越来越复杂。...</dc:description>
<dc:creator>阮一峰</dc:creator>
<dc:date>2012-10-26T08:32:33+08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->


    
    <link rel="prev" href="http://www.ruanyifeng.com/blog/2014/10/real-leadership-lessons-of-steve-jobs.html" title="乔布斯的管理课">
    <link rel="next" href="http://www.ruanyifeng.com/blog/2014/11/compiler.html" title="编译器的工作过程">
    
    <title>JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志</title>
<script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bsStatic.js.下载" type="text/javascript" charset="utf-8"></script><script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/fingerprint2.min.js.下载" type="text/javascript" charset="utf-8"></script><script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bs-engine.js.下载" type="text/javascript" charset="utf-8"></script><style type="text/css">a.bshareDiv,#bsPanel,#bsMorePanel,#bshareF{border:none;background:none;padding:0;margin:0;font:12px Helvetica,Calibri,Tahoma,Arial,宋体,sans-serif;line-height:14px;}#bsPanel div,#bsMorePanel div,#bshareF div{display:block;}.bsRlogo .bsPopupAwd,.bsRlogoSel .bsPopupAwd,.bsLogo .bsPopupAwd,.bsLogoSel .bsPopupAwd{line-height:16px !important;}a.bshareDiv div,#bsFloatTab div{*display:inline;zoom:1;display:inline-block;}a.bshareDiv img,a.bshareDiv div,a.bshareDiv span,a.bshareDiv a,#bshareF table,#bshareF tr,#bshareF td{text-decoration:none;background:none;margin:0;padding:0;border:none;line-height:1.2}a.bshareDiv span{display:inline;float:none;}div.buzzButton{cursor:pointer;font-weight:bold;}.buzzButton .shareCount a{color:#333}.bsStyle1 .shareCount a{color:#fff}span.bshareText{white-space:nowrap;}span.bshareText:hover{text-decoration:underline;}a.bshareDiv .bsPromo,div.bshare-custom .bsPromo{display:none;position:absolute;z-index:100;}a.bshareDiv .bsPromo.bsPromo1,div.bshare-custom .bsPromo.bsPromo1{width:51px;height:18px;top:-18px;left:0;line-height:16px;font-size:12px !important;font-weight:normal !important;color:#fff;text-align:center;background:url(http://static.bshare.cn/frame/images/bshare_box_sprite2.gif) no-repeat 0 -606px;}div.bshare-custom .bsPromo.bsPromo2{background:url(http://static.bshare.cn/frame/images/bshare_promo_sprite.gif) no-repeat;cursor:pointer;}</style><style type="text/css">.bsBox{display:none;z-index:100000001;font-size:12px;background:url(http://static.bshare.cn/frame/images//background-opaque-dark.gif) !important;padding:6px !important;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;}.bsClose{_overflow:hidden;cursor:pointer;position:absolute;z-index:10000000;color:#666;font-weight:bold;font-family:Helvetica,Arial;font-size:14px;line-height:20px;}.bsTop{color:#666;background:#f2f2f2;height:24px;line-height:24px;border-bottom:1px solid #e8e8e8;}.bsTop span{float:left;}.bsFrameDiv,#bsMorePanel{border:none;background:#fff;}.bsReturn{float:right;*margin-right:20px;margin-right:36px;text-align:right;cursor:pointer;line-height:24px;color:#666;opacity:0.5;}#bsReturn:hover{text-decoration:underline;opacity:1;}</style><script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bsMore.js.下载" type="text/javascript" charset="utf-8"></script><script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bshareS1.js.下载" type="text/javascript" charset="utf-8"></script><style type="text/css">div.bsClear{clear:both;height:0;line-height:0;overflow:hidden;font-size:0;}.bsSearchDiv{padding:5px 15px;background-color:#fafafa;}.bFind-wrapper-top{background:#fff;border-color:#ccc #aaa #aaa #ccc;border-style:solid;border-width:1px;height:16px;padding:4px;margin:0;}.bFind-wrapper-top input{padding:0 !important;border:none !important;box-shadow:none !important;line-height:16px !important;}.bFind-placeholder{background:url("http://static.bshare.cn/css/images/search-icon.gif") no-repeat;display:block;float:left;height:16px;width:16px;}.bFind{background:none;border:none;float:left;font-size:11px !important;height:16px !important;margin-left:3px;outline:none;padding:0;width:400px;}.bsPlatDiv{height:322px;background:#fff;overflow:auto;padding:0 15px;}#bsLogoList{display:block;list-style:none;overflow:hidden;margin:0;padding:0;}#bsLogoList li{float:left;display:inline-block;width:71px;text-align:center;font-size:12px;height:80px;margin:0 !important;}#bsLogoList .bsPlatIcon{cursor:pointer;display:block !important;text-align:center;}#bsLogoList .bsPlatImg{width:32px;height:32px;border:none !important;display:inline-block;}#bsLogoList .bsPlatImg:hover{-moz-border-radius:7px;-webkit-border-radius:7px;border-radius:7px;box-shadow:0 0 15px #a7a8ac;}#bsLogoList .bsPlatName{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;text-align:center;color:#333 !important;margin-top:2px;line-height:140%;*width:70px;}#bsLogoList .bsPromoM{text-align:center;}.bsFooterDiv{height:24px;line-height:24px;padding:0 15px;border-top:1px solid #e8e8e8;background:#f2f2f2;text-align:right;}a.bsLogoLink{color:#666;}.bsLogoLink:hover{text-decoration:underline;}.bsPromoM{background:url(http://static.bshare.cn/frame/images//bshare_box_sprite2.gif) no-repeat top left;}.bsNew,.bsHot,.bsRec,.bsAwd{background-position:0 -552px;width:19px;margin:5px auto 1px;line-height:16px;height:18px;font-size:12px;color:#fff;overflow:hidden;}.bsNew{background-position:0 -570px;}.bsRec{width:30px;background-position:0 -588px;}.bsAwd{background:url(http://static.bshare.cn/frame/images//promot/promote.gif) no-repeat;}</style><script src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bshare_view" type="text/javascript" charset="utf-8"></script><style type="text/css">a.bsSiteLink{text-decoration:none;color:#666;}a.bsSiteLink:hover{text-decoration:underline;}a.bshareDiv{overflow:hidden;height:16px;line-height:18px;font-size:14px;color:#333;padding-left:0;}a.bshareDiv:hover{text-decoration:none;}div.bsTitle{padding:0 8px;border-bottom:1px solid #e8e8e8;color:#666;background:#f2f2f2;text-align:left;}div.buzzButton{cursor:pointer;}div.bsRlogo,div.bsRlogoSel{width:68px;float:left;margin:0;padding:2px 0;}div.bsRlogo a,div.bsRlogoSel a{float:left;}div.bsLogo,div.bsLogoSel{float:left;width:111px;text-align:left;height:auto;padding:2px 4px;margin:2px 0;white-space:nowrap;overflow:hidden;}div.bsLogoSel,div.bsRlogoSel{border:1px solid #ddd;background:#f1f1f1;}div.bsLogo,div.bsRlogo{border:1px solid #fff;background:#fff;}div.bsLogo a,div.bsLogoSel a{display:block;height:16px;line-height:16px;padding:0 0 0 24px;text-decoration:none;float:left;overflow:hidden;}div.bsLogoSel a,div.bsRlogoSel a{color:#000;border:none;}div.bsLogo a,div.bsRlogo a{color:#666;border:none;}div.bsLogoLink{width:121px;overflow:hidden;background:#FFF;float:left;margin:3px 0;}#bsLogin{float:right;text-align:right;overflow:hidden;height:100%;}#bsPanel{position:absolute;z-index:100000000;font-size:12px;width:258px;background:url(http://static.bshare.cn/frame/images/background-opaque-dark.png) !important;padding:6px !important;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;}div.bsClear{clear:both;height:0;line-height:0;font-size:0;overflow:hidden;}div.bsPopupAwd{background:url(http://static.bshare.cn/frame/images//bshare_box_sprite2.gif) no-repeat top left;background-position:0 -624px;width:18px;padding-left:3px;text-align:center;float:left;margin-left: 2px;height:15px;font-size:12px;color:#fff;overflow:hidden;}div.bsRlogo .bsPopupAwd,div.bsRlogoSel .bsPopupAwd{float:left;margin:5px 0 0 -14px;}</style><style type="text/css">a.bsSiteLink{text-decoration:none;color:#666;}a.bsSiteLink:hover{text-decoration:underline;}a.bshareDiv{overflow:hidden;height:16px;line-height:18px;font-size:14px;color:#333;padding-left:0;}a.bshareDiv:hover{text-decoration:none;}div.bsTitle{padding:0 8px;border-bottom:1px solid #e8e8e8;color:#666;background:#f2f2f2;text-align:left;}div.buzzButton{cursor:pointer;}div.bsRlogo,div.bsRlogoSel{width:68px;float:left;margin:0;padding:2px 0;}div.bsRlogo a,div.bsRlogoSel a{float:left;}div.bsLogo,div.bsLogoSel{float:left;width:111px;text-align:left;height:auto;padding:2px 4px;margin:2px 0;white-space:nowrap;overflow:hidden;}div.bsLogoSel,div.bsRlogoSel{border:1px solid #ddd;background:#f1f1f1;}div.bsLogo,div.bsRlogo{border:1px solid #fff;background:#fff;}div.bsLogo a,div.bsLogoSel a{display:block;height:16px;line-height:16px;padding:0 0 0 24px;text-decoration:none;float:left;overflow:hidden;}div.bsLogoSel a,div.bsRlogoSel a{color:#000;border:none;}div.bsLogo a,div.bsRlogo a{color:#666;border:none;}div.bsLogoLink{width:121px;overflow:hidden;background:#FFF;float:left;margin:3px 0;}#bsLogin{float:right;text-align:right;overflow:hidden;height:100%;}#bsPanel{position:absolute;z-index:100000000;font-size:12px;width:258px;background:url(http://static.bshare.cn/frame/images/background-opaque-dark.png) !important;padding:6px !important;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;}div.bsClear{clear:both;height:0;line-height:0;font-size:0;overflow:hidden;}div.bsPopupAwd{background:url(http://static.bshare.cn/frame/images//bshare_box_sprite2.gif) no-repeat top left;background-position:0 -624px;width:18px;padding-left:3px;text-align:center;float:left;margin-left: 2px;height:15px;font-size:12px;color:#fff;overflow:hidden;}div.bsRlogo .bsPopupAwd,div.bsRlogoSel .bsPopupAwd{float:left;margin:5px 0 0 -14px;}</style></head>
<body id="scrapbook" class="mt-entry-archive one-column">
<script>
if (/mobile/i.test(navigator.userAgent) || /android/i.test(navigator.userAgent)) document.body.classList.add('mobile');

window.addEventListener('load', function(event) {
  setTimeout(function () {
    hab('#sup-post-2');
    hab('#gd1-inner');
  }, 1000);
});
</script>
    <div id="container">
        <div id="container-inner">

            <div id="header">
    <div id="header-inner">
        <div id="header-content">


            <div id="header-name">阮一峰的网络日志 <span id="site_location"> » <a href="http://www.ruanyifeng.com/blog/" accesskey="1">首页</a></span><span id="site_archive"> » <a href="http://www.ruanyifeng.com/blog/archives.html">档案</a></span>
</div>

<div id="google_search">
<!-- SiteSearch Google -->
<form action="http://www.ruanyifeng.com/blog/search.html" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="016304377626642577906:b_e9skaywzq">
    <input type="hidden" name="cof" value="FORID:11">
    <input type="hidden" name="ie" value="UTF-8">
        <input type="text" name="q" size="20" class="searchbox" id="sbi" value="">
        <input type="image" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/top_search_submit.gif" class="searchbox_submit" value="" alt="搜索" name="sa">
      </div>
    </form>
<!-- SiteSearch Google -->
</div>
<div id="feed_icon">
<a href="http://www.ruanyifeng.com/feed.html" title="订阅Feed">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAUzSURBVHjavFdbbFRVFF3nPjoz7dTWTittaW0jUDRAUqaNojyqREnEQKgfUj9MqqAmhqRt/OCD4CuY+Kckoh+aiGKC+gMJbdHoRysJ8dkhhmJLNdDKtJU+6GMK87j3Hs85d2Z6HzNtMYWb3Dn3NWftvfba+5xNYDl+e6Fkj6yqb/oDRbWq14vlPBLRKCITkxf0ROLt+hNjp1PPSRK4kA3vF1dXNRcWlyA2OQU9eos9opAkAiKxD+XkKO6t15aRWO7J/MgmAZU8MEgexgZHMX518Dh72sYMmVKShnxWuWHdHtxKIDIYTgMuDzgfmSOIQkYMpdUF8OY92Hytt4/jvkg47czzU16iQovM3QFwmNck+Yyduu7D6NA0Z6JR4THntFs9V4tWQg6Ui3s6MwKDncsFTnXKLJhDSeUK3AgPtyhccDzmVs999buRt/1Vm4i0od+hX7+MRG87jPGB/w1u8FPj9xEw7McVrnYuOCvtpjTth3J/nTg99c8LRhKhr6D3dTB5R24bXFwbMXBsyZzeoXaycEpJ95TB09AGX/NpqLVNtw8urnVzLvHjFNxiFqRy2OOHuqUVnue+ACkoWzo4O6lGzTmuHq6nPvY2m9rVqjrIK2rMEKxqyG5NPAKt+wjo0LklgfNxJkZMA3KJvqRUk3z5UFY3QH14P0h+WUY79HPvgv7VuSg4ZRGY1YgZgqXmORccF17sy2ehnf9AeO085K2HQFbtXBScj0LcpgF2cN+WV+DZ/LJQu6gD4R7oV7pBJwbSgtMvfiPoVp56DySwxm7EtkMs1WdAB7qzggsDJKQYsHucSkOudrkiCPWR/fA2nYCn8SNIK4NptSMyAu3sAdDRkIsJdfth0LzSrODUoPNZ4KI9SxJI5UHk7D4GdQfz2us31c7CoHMjRkKuDPHseCMrONVhNcDJwMJpKFVvg9L4OaTiNWm1x789KCqkrXhVBiEz0WYCT2nAzQAD1/vaETv1GrRfP4Vx5cfMNcDPwvP0h0DhanPym7OIf/+O67vcJ1/PCJ4KgdzaUP6Wz+dU+5yIL6fV+PsHGAOdwlPpvvUOyeeAVGyCdqkDNB6DPjsBSrnndfOGevOh3RhGItxvA+fX1CtbGFhgYUFkFMZPR6F1HnClHq8HyubWtJexX06CRmdt33hrd7nA7SFY4qoGpnYuOKcRykPPgDCBcsHx9Iv+fNL2PueBehCWUfYQIIMGLOCcOmXDXsh1+yCt35tUPfvzGFuSvzvoinXOxqa02qOhM6733nVP2MAdaej2XN11DPKjLZCD+yBvahGCo7JfTKAN9UD7s8Oe9zUNIhz8fWI8DG2k38WCFdxugANcXrvTVd1IEbuv3Jour7Hzn7jLMBNfKs7R3i67gRVrbeCOEDhinmWhAatsqdquM2XzHZINhK2cqTjHr/XZdVJUbgN3MWAVXKbSyg9jesRW2xP9di+lwrL5ojM3m2H/kG9hwcIA37c71W6wJdW2J2S5nrjYbq/t1AHAhJsKQeyfPvf6IMJgghPJhFZ4x0KlfLFvt22du45Au/A1SOlGc0P672XXwhLtOcM0kTTEMMd0qkVmMNXxMd/tsedUjInr4SQDgOfeXMSiN0FCL5WHah4L1qqYXPJOJlttd+a5M+YpcG5poLYKQ5f+6JJ4r8bbJYP47hq4r7QAs9PjYNhHJd4o8l5taiwuOpa7AS4XKqI/5NjJbTnaWK92nLdLuhQAJayRNMiygXPBeQN+Qbvu0zDc3y+aUzhbkGR73sI7ljvUnndx2q3t+X8CDAD66FtrIL864AAAAABJRU5ErkJggg==" alt="" style="border: 0pt none;">
</a></div>

        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <div id="entry-1816" class="entry-asset asset hentry">
                                <div class="asset-header">
<div class="asset-nav entry-nav">

<div class="entry-location">
<ul>
<li>上一篇：<a href="http://www.ruanyifeng.com/blog/2014/10/real-leadership-lessons-of-steve-jobs.html" title="乔布斯的管理课">乔布斯的管理课&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
<li>下一篇：<a href="http://www.ruanyifeng.com/blog/2014/11/compiler.html" title="编译器的工作过程">编译器的工作过程&nbsp;&nbsp;&nbsp;</a></li>
</ul>
</div>


    
                                    <div class="entry-categories">
                                        <p>分类<span class="delimiter">：</span></p>
                                        <ul>
                                            <li><a href="http://www.ruanyifeng.com/blog/javascript/" rel="tag">JavaScript</a></li>
                                        </ul>
                                    </div>
    


                                            
</div>
                                </div>
<article class="hentry">
                                    <h1 id="page-title" class="asset-name entry-title">JavaScript 运行机制详解：再谈Event Loop</h1>
                                            <div id="share_button" style="float:right;padding-right:2em;padding-top:1em;">
<a class="bshareDiv" href="http://www.bshare.cn/share" style="display: block; text-decoration: none; padding: 0px; margin: 0px; font-size: 12px; height: 21px; width: 51px;"><div class="bsPromo bsPromo1"></div><div class="buzzButton bsStyle10" style="height:21px;color:#333;;background:transparent url(http://static.bshare.cn/frame/images/button_custom10-zh-Orange.gif) no-repeat;text-align:center;width:51px;"></div><div style="clear:both;"></div></a>



<script type="text/javascript" charset="utf-8" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/buttonLite.js.下载"></script>
<script type="text/javascript" charset="utf-8">
bShare.addEntry({
    title: document.getElementById("page-title").innerHTML,
url:window.location.href
});
</script>
</div>
                                    <div class="asset-meta">
                                        

                                            <p class="vcard author">作者： <a class="fn url" href="http://www.ruanyifeng.com/">阮一峰</a></p>
                                    <p>日期： <a href="http://www.ruanyifeng.com/blog/2014/10/"><abbr class="published" title="2014-10-08T21:11:16+08:00">2014年10月 8日</abbr></a></p>


                                    </div>
                                
                                <div class="asset-content entry-content" id="main-content">

                                    <!-- div class="asset-body" -->
                                        <p>一年前，我写了一篇<a href="http://www.ruanyifeng.com/blog/2013/10/event_loop.html" target="_blank">《什么是 Event Loop？》</a>，谈了我对Event Loop的理解。</p>

                                    <!-- /div -->


                                    <!-- div id="more" class="asset-more" -->
                                        <p>上个月，我偶然看到了Philip Roberts的演讲<a href="http://vimeo.com/96425312" target="_blank">《Help, I'm stuck in an event-loop》</a>。这才尴尬地发现，自己的理解是错的。我决定重写这个题目，详细、完整、正确地描述JavaScript引擎的内部运行机制。下面就是我的重写。</p>

<p>进入正文之前，插播一条消息。我的新书<a href="http://es6.ruanyifeng.com/" target="_blank">《ECMAScript 6入门》</a>出版了（<a href="http://es6.ruanyifeng.com/images/copyright.png" target="_blank">版权页</a>，<a href="http://es6.ruanyifeng.com/images/page1.png" target="_blank">内页1</a>，<a href="http://es6.ruanyifeng.com/images/page2.png" target="_blank">内页2</a>），铜版纸全彩印刷，非常精美，还附有索引（当然价格也比同类书籍略贵一点点）。预览和购买点击<a href="http://es6.ruanyifeng.com/" target="_blank">这里</a>。</p>

<p><a href="http://es6.ruanyifeng.com/images/cover.jpg" target="_blank"><img src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/cover_thumbnail.jpg" alt="cover" title=""></a></p>

<p>（<strong>2014年10月13日更新</strong>：本文已经做了较大修改，反映了我现在的认识。关于setTimeout的更多解释和示例，请参阅我正在写的<a href="http://javascript.ruanyifeng.com/bom/timer.html" target="_blank">《JavaScript标准参考教程》</a>。）</p>

<p>（<strong>2014年10月11日更新</strong>：朴灵老师对本文做了<a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead" target="_blank">评注</a>，详细得指出了文中存在的错误说法，建议阅读。）</p>

<h2>一、为什么JavaScript是单线程？</h2>

<p>JavaScript语言的一大特点就是单线程，也就是说，同一个时间只能做一件事。那么，为什么JavaScript不能有多个线程呢？这样能提高效率啊。</p>

<p>JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？</p>

<p>所以，为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变。</p>

<p>为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。</p>

<h2>二、任务队列</h2>

<p>单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。</p>

<p>如果排队是因为计算量大，CPU忙不过来，倒也算了，但是很多时候CPU是闲着的，因为IO设备（输入输出设备）很慢（比如Ajax操作从网络读取数据），不得不等着结果出来，再往下执行。</p>

<p>JavaScript语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。</p>

<p>于是，所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。</p>

<p>具体来说，异步执行的运行机制如下。（同步执行也是如此，因为它可以被视为没有异步任务的异步执行。）</p>

<blockquote>
  <p>（1）所有同步任务都在主线程上执行，形成一个<a href="http://www.ruanyifeng.com/blog/2013/11/stack.html" target="_blank">执行栈</a>（execution context stack）。</p>

<p>（2）主线程之外，还存在一个"任务队列"（task
queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。</p>

<p>（3）一旦"执行栈"中的所有同步任务执行完毕，系统就会读取"任务队列"，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。</p>

<p>（4）主线程不断重复上面的第三步。</p>
</blockquote>

<p>下图就是主线程和任务队列的示意图。</p>

<p><img src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bg2014100801.jpg" alt="任务队列" title=""></p>

<p>只要主线程空了，就会去读取"任务队列"，这就是JavaScript的运行机制。这个过程会不断重复。</p>

<h2>三、事件和回调函数</h2>

<p>"任务队列"是一个事件的队列（也可以理解成消息的队列），IO设备完成一项任务，就在"任务队列"中添加一个事件，表示相关的异步任务可以进入"执行栈"了。主线程读取"任务队列"，就是读取里面有哪些事件。</p>

<p>"任务队列"中的事件，除了IO设备的事件以外，还包括一些用户产生的事件（比如鼠标点击、页面滚动等等）。只要指定过回调函数，这些事件发生时就会进入"任务队列"，等待主线程读取。</p>

<p>所谓"回调函数"（callback），就是那些会被主线程挂起来的代码。异步任务必须指定回调函数，当主线程开始执行异步任务，就是执行对应的回调函数。</p>

<p>"任务队列"是一个先进先出的数据结构，排在前面的事件，优先被主线程读取。主线程的读取过程基本上是自动的，只要执行栈一清空，"任务队列"上第一位的事件就自动进入主线程。但是，由于存在后文提到的"定时器"功能，主线程首先要检查一下执行时间，某些事件只有到了规定的时间，才能返回主线程。</p>

<h2>四、Event Loop</h2>

<p>主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）。</p>

<p>为了更好地理解Event Loop，请看下图（转引自Philip Roberts的演讲<a href="http://vimeo.com/96425312" target="_blank">《Help, I'm stuck in an event-loop》</a>）。</p>

<p><img src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bg2014100802.png" alt="Event Loop" title=""></p>

<p>上图中，主线程运行的时候，产生堆（heap）和栈（stack），栈中的代码调用各种外部API，它们在"任务队列"中加入各种事件（click，load，done）。只要栈中的代码执行完毕，主线程就会去读取"任务队列"，依次执行那些事件所对应的回调函数。</p>

<p>执行栈中的代码（同步任务），总是在读取"任务队列"（异步任务）之前执行。请看下面这个例子。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>    
    req<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    
    req<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    
    req<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></blockquote>

<p>上面代码中的req.send方法是Ajax操作向服务器发送数据，它是一个异步任务，意味着只有当前脚本的所有代码执行完，系统才会去读取"任务队列"。所以，它与下面的写法等价。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
    <span class="token keyword">var</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    
    req<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   
</code></pre></blockquote>

<p>也就是说，指定回调函数的部分（onload和onerror），在send()方法的前面或后面无关紧要，因为它们属于执行栈的一部分，系统总是执行完它们，才会去读取"任务队列"。</p>

<h2>五、定时器</h2>

<p>除了放置异步任务的事件，"任务队列"还可以放置定时事件，即指定某些代码在多少时间之后执行。这叫做"定时器"（timer）功能，也就是定时执行的代码。</p>

<p>定时器功能主要由setTimeout()和setInterval()这两个函数来完成，它们的内部运行机制完全一样，区别在于前者指定的代码是一次性执行，后者则为反复执行。以下主要讨论setTimeout()。</p>

<p>setTimeout()接受两个参数，第一个是回调函数，第二个是推迟执行的毫秒数。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></blockquote>

<p>上面代码的执行结果是1，3，2，因为setTimeout()将第二行推迟到1000毫秒之后执行。</p>

<p>如果将setTimeout()的第二个参数设为0，就表示当前代码执行完（执行栈清空）以后，立即执行（0毫秒间隔）指定的回调函数。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
<span class="token function">setTimeout<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></blockquote>

<p>上面代码的执行结果总是2，1，因为只有在执行完第二行以后，系统才会去执行"任务队列"中的回调函数。</p>

<p>总之，setTimeout(fn,0)的含义是，指定某个任务在主线程最早可得的空闲时间执行，也就是说，尽可能早得执行。它在"任务队列"的尾部添加一个事件，因此要等到同步任务和"任务队列"现有的事件都处理完，才会得到执行。</p>

<p>HTML5标准规定了setTimeout()的第二个参数的最小值（最短间隔），不得低于4毫秒，如果低于这个值，就会自动增加。在此之前，老版本的浏览器都将最短间隔设为10毫秒。另外，对于那些DOM的变动（尤其是涉及页面重新渲染的部分），通常不会立即执行，而是每16毫秒执行一次。这时使用requestAnimationFrame()的效果要好于setTimeout()。</p>

<p>需要注意的是，setTimeout()只是将事件插入了"任务队列"，必须等到当前代码（执行栈）执行完，主线程才会去执行它指定的回调函数。要是当前代码耗时很长，有可能要等很久，所以并没有办法保证，回调函数一定会在setTimeout()指定的时间执行。</p>

<h2>六、Node.js的Event Loop</h2>

<p>Node.js也是单线程的Event Loop，但是它的运行机制不同于浏览器环境。</p>

<p>请看下面的示意图（作者<a href="https://twitter.com/BusyRich/status/494959181871316992" target="_blank">@BusyRich</a>）。</p>

<p><img src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/bg2014100803.png" alt="Node.js" title=""></p>

<p>根据上图，Node.js的运行机制如下。</p>

<blockquote>
  <p>（1）V8引擎解析JavaScript脚本。</p>

<p>（2）解析后的代码，调用Node API。</p>

<p>（3）<a href="https://github.com/joyent/libuv" target="_blank">libuv库</a>负责Node
API的执行。它将不同的任务分配给不同的线程，形成一个Event Loop（事件循环），以异步的方式将任务的执行结果返回给V8引擎。</p>

<p>（4）V8引擎再将结果返回给用户。</p>
</blockquote>

<p>除了setTimeout和setInterval这两个方法，Node.js还提供了另外两个与"任务队列"有关的方法：<a href="http://nodejs.org/docs/latest/api/process.html#process_process_nexttick_callback" target="_blank">process.nextTick</a>和<a href="http://nodejs.org/docs/latest/api/timers.html#timers_setimmediate_callback_arg" target="_blank">setImmediate</a>。它们可以帮助我们加深对"任务队列"的理解。</p>

<p>process.nextTick方法可以在当前"执行栈"的尾部----下一次Event Loop（主线程读取"任务队列"）之前----触发回调函数。也就是说，它指定的任务总是发生在所有异步任务之前。setImmediate方法则是在当前"任务队列"的尾部添加事件，也就是说，它指定的任务总是在下一次Event Loop时执行，这与setTimeout(fn, 0)很像。请看下面的例子（via <a href="http://stackoverflow.com/questions/17502948/nexttick-vs-setimmediate-visual-explanation" target="_blank">StackOverflow</a>）。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
process<span class="token punctuation">.</span><span class="token function">nextTick<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">A<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  process<span class="token punctuation">.</span><span class="token function">nextTick<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">B<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">timeout<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'TIMEOUT FIRED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">
// 1
</span><span class="token comment" spellcheck="true">// 2
</span><span class="token comment" spellcheck="true">// TIMEOUT FIRED
</span></code></pre></blockquote>

<p>上面代码中，由于process.nextTick方法指定的回调函数，总是在当前"执行栈"的尾部触发，所以不仅函数A比setTimeout指定的回调函数timeout先执行，而且函数B也比timeout先执行。这说明，如果有多个process.nextTick语句（不管它们是否嵌套），将全部在当前"执行栈"执行。</p>

<p>现在，再看setImmediate。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
<span class="token function">setImmediate<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">A<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setImmediate<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">B<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">timeout<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'TIMEOUT FIRED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></blockquote>

<p>上面代码中，setImmediate与setTimeout(fn,0)各自添加了一个回调函数A和timeout，都是在下一次Event Loop触发。那么，哪个回调函数先执行呢？答案是不确定。运行结果可能是1--TIMEOUT FIRED--2，也可能是TIMEOUT FIRED--1--2。</p>

<p>令人困惑的是，Node.js文档中称，setImmediate指定的回调函数，总是排在setTimeout前面。实际上，这种情况只发生在递归调用的时候。</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
<span class="token function">setImmediate<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setImmediate<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">A<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setImmediate<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">B<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">timeout<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'TIMEOUT FIRED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">
// 1
</span><span class="token comment" spellcheck="true">// TIMEOUT FIRED
</span><span class="token comment" spellcheck="true">// 2
</span></code></pre></blockquote>

<p>上面代码中，setImmediate和setTimeout被封装在一个setImmediate里面，它的运行结果总是1--TIMEOUT FIRED--2，这时函数A一定在timeout前面触发。至于2排在TIMEOUT FIRED的后面（即函数B在timeout后面触发），是因为setImmediate总是将事件注册到下一轮Event Loop，所以函数A和timeout是在同一轮Loop执行，而函数B在下一轮Loop执行。</p>

<p>我们由此得到了process.nextTick和setImmediate的一个重要区别：多个process.nextTick语句总是在当前"执行栈"一次执行完，多个setImmediate可能则需要多次loop才能执行完。事实上，这正是Node.js 10.0版添加setImmediate方法的原因，否则像下面这样的递归调用process.nextTick，将会没完没了，主线程根本不会去读取"事件队列"！</p>

<blockquote><pre class=" language-javascript"><code class=" language-javascript">
process<span class="token punctuation">.</span><span class="token function">nextTick<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span><span class="token function">nextTick<span class="token punctuation">(</span></span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></blockquote>

<p>事实上，现在要是你写出递归的process.nextTick，Node.js会抛出一个警告，要求你改成setImmediate。</p>

<p>另外，由于process.nextTick指定的回调函数是在本次"事件循环"触发，而setImmediate指定的是在下次"事件循环"触发，所以很显然，前者总是比后者发生得早，而且执行效率也高（因为不用检查"任务队列"）。</p>

<p>（完）</p>

                                    <!-- /div -->

                                </div>
    <script type="text/javascript" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/newwindow.js.下载"></script>
                                <div class="asset-footer">

<h3>文档信息</h3>
<ul>
<li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">创意共享3.0许可证</a>）</li>
<li>发表日期： <abbr class="published" title="2014-10-08T21:11:16+08:00">2014年10月 8日</abbr></li>
<li>更多内容： <a href="http://www.ruanyifeng.com/blog/archives.html" target="_blank"> 档案</a>  » 
<a href="http://www.ruanyifeng.com/blog/javascript/"> JavaScript</a> 
</li>
<li>博客文集：<a href="http://road.ruanyifeng.com/" target="_blank">《前方的路》</a>，<a href="https://ruanyf.github.io/survivor" target="_blank">《未来世界的幸存者》</a></li>
<li>社交媒体：<a href="https://twitter.com/ruanyf" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAk1JREFUeNqsVc9rE0EU/mZ3dhPNJl2bVIk/Km09aFBE8GLvnrwJXvwLxIsgCP4Fnit6E8Gb0IMHwUsL9SSNgiAoooJIpE1Joo1h82uT7IxvxmRN3Q32kAdvdrI773vfe+/bDTu9WioDcDAda3Ja8piepQ1avCkCeny0Y+R9KenKwOmHHLvPaKn7AtVOoO8dOWDCMpg+41gMQv5FNEJACgoE8MsPNLDBhgfoutMOsJDmWLmU037C4TApciljwQ/kHoohQxV06+wMXNvE7WINuaSpvdYVKLgWnl3O4zAxU3Z1IYVGT+B5qYWV9z2kbQaT/cOwTsxOUUYF+mB5Dkmi8HG3h2q9hxsFNwRTdvQgxxnXRrMvIdkEhllis/qtiWuLDm4WZnBlPoWnXz28LHdw0uGR7m9Wu3j0qYGEubfn4UlBfXO4gTZltRNMg9w9f0i7kNFxllsBlS0x75gYfxyWTBUjT2W5CSMSPBrQuG21+hiMDS8CeCzF8eSLp13uQ3Ab1IqMFZN8tFHPmgOBF99bYP8Be1Xp6t7OJszJgKpPSiZvaj7uf2hguz2IBQuozDvFH6RDBjuK9wdQDvt0nMpW+8efGyh5UcAeZb2+UcHbnz5Jx4wdlp4yJYU3kLiQtfBwOYeLc8nIwfXtNu69q2Oz4mMxbemYOOOjKarhvq51KUjg3GwiFPIuvcNF6pnSnWK0lOEabNLgQh1aJFAhlGB9rG110B2+oyRNPc0sZbRNFltmLKDKqj4Qrm1ojzOxDz2pyPQ0P7CK4c40/wJ+CzAAGYrXsvfFXR4AAAAASUVORK5CYII=" style="border:0;"> twitter</a>，<a href="http://weibo.com/ruanyf" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAABPZJREFUeNqMyXtM1WUcx/FnNTdreAVCEEThyEFUrM2kwkpS05qVl8rugVpRUelaJdZaWWktdZKHssImgV04osgBCbwAa2Whm6GWoXHxcD1wHiI4t9/z/H68+wO3av1R3+217/b+CFStsHq/W2V1HW+wOmq8VkeN/E+dR/7SUSOtrmOnLc93jxA6LsTw71XLrUsHsNwHsdxl/09HGVb7QawOF1bn4ZF26QDDsmqNsH7be9psKcJs+fy/tRZjXvwM//678BVdT6BsMarhxZHeug+reW+TMC84+s0LDv4tH7PZgdXqwGrLx7yYP9KaHISOvUCwYh3+4iUMOiIJVmSMbBfy+4X581Zp/ryVfzi/FfPXd1AntxNwvkvg6zfQZ7Zg/rIV8/x7qB9fJlT/JPrcm4SOPctg3ihCR5dhNu2QQjfmSt2Yi27MRf+Uiz67Ef1TLv7Ct5CPZtMzJ4N2243Ij7Kwmjdhnt+EUZeFr/BmhvYkoBqewl8yD9/eCejGTVLoUzlSn8pBn8xBn85B/fAcf7z6PJ7rl9KdNBdP6nwuJc2jL+9+jJrXGNr1On9seZHgkQ0ESq8l4EzBOLKMod1XoE6slUKfXCd1wxp0Qxb6RBYDLzxGz8xb8aSm05u2kL4bF9N902I89yzHe986PEseoGP2YjqfvpNQeTr+4rmEKucz6LgS9f1jUuiy+VIfvxvz1GoGN99Hz8wFeGan0zl3Ae4lK3A/vJb2x7PpWPEI3bevoHfJKtypt9H1UgbDZx5E//goofJF+AtmoasWSaG2jZE6P5zg9hQ8Nyyie1Y6rQ+vpafMhdHXx7BpgjWMr7sbT5kL9/IHcUck0X3LtfgLVqAP3YAumoHeHYvaPkYKlRcudf54Bh5KpjP5Fi69tplgIMCQabK/rIxtO3bgqqxkmJHzdXbRknYbrWIcrWEJ9D8RjXaMRe2ciNo5QQr1QYRUjnC8C1Nxr1pD0O/HFwyQmZmJ3W4nLS0Nm83G+vXrsSwLgP6vS2kWo/lNjKN57gTMTyJRH0Si8iZKoXZdI5Ujkt55SXRtfBuAffv2sXLlSpxOJ9nZ2SQkJBAWFobX6wVgoPooLWI0v4hxuFeFY30ahdoVhcqLkEJ9GCV1QRTehZNxZ9wPQNGXX5KZmUlbWxspKSkIIUhPT0dZFibQvSaHJjGKxujxBHZGoT+ehPpwEsoRIYUqmCR1YTTBd2NoGxtOz4Y3CPoDrNuwnuhpU7lq/HgW3LGU5l4P2h+g55XNnBOjORM/jsH3ozGLYlAFMag90ahPI6VQxZOlKo5BOyfjey+GliljaL0uA7l9D2f37uess5KBoyfwbvmIJnsajVePouXeCIKFsZglsajiyX8pvEYKoySm33DGYTjj0OVxhEri6N84kfalY2i/NRb3AhvNN0+i9Y4wPC+H4yuMxTocjzoYj7F/ymVxI/+ryH5huKaeMVzxGK54QuXT8B+y4atIZqB8Nt6SVDzFqXi+mIO39Dp+PziHwdIZDJVOJ3gogZArHsM1BcMVj1E+BcMVe1GY38auNqqnYdQkEKpOJPBNEv7DdnyVdnwVdoYqki+bge9wCv6qFAJVyQS/mU6oJhHjSCJG9VSM6kRUfXi2GK6fJYy6+CyjNrHRqLP1GbWJ0qizSfV39Tap6qdLVW+Xqt4ujfokadRdVpvgNWpt54y6qc8MV44Sfw4An+t+Gj1AKyYAAAAASUVORK5CYII=" style="border:0;"> weibo</a></li>
<li>Feed订阅： <a href="http://www.ruanyifeng.com/feed.html" target="_blank"><img src="data:image/gif;base64,R0lGODlhFAAUANU2APV1GfmrePZ8IeR5VPq2ieNkLf7p3NpFJveCJ/NoFfibVPR1IexiJfvdzuZrNfXGuOhUEueTevaFOfzIpNxDGeZZJNU6IOubifiVTfOnid1aLuZpLOFSJf/28vJtIvGcefaLSd5kNu9iFv/z6//48//t4uFfLfNkCeJNGuGNc/rCof/+/PVxEeldI/V5KeKMbu9nIvB2OvzQtNxMKfOPXP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADYALAAAAAAUABQAAAb/QJstEjKZCsjCZsl0pIS2QWXaYsA8noVWIEAgFoNhhWNyMESi7Jbr/aZCFdRnZJAFJCwAt+vlOkwtEBk1hDUkExJ6bQJaGyYMLTQTDSOFHQF8jAseSFYiJwkuAQ2FE1xaHjBIMDAgARguJwABJIQTLJswDEgeIgSEJQQILAqVNQEiui1HHgkBhTUGCiwYtR0xLS0VJhtaEgoEBoQkGCfPNSoQY9xaCwAsCBPALgmkJA4cZN0CAAgY/PJqEIDwgVAECjM0bOAnwcAKGQJclKhRgoGDDjUeUDigkN8vQiBOfByAglSDAxw3IBCgYEU0FyJoEPpA4UGNDjMsaHDQR8EdPVYOMmQYQGHAhQgHLIRIsWAlgASsGMRBMWMGBQtYZ7yIsoBRKkhjOMxAiXJGGCEpHGxIYsSIhrcaQmy1EQQAOw==" style="border:0;"></a></li>

</ul>
                                </div>
</article>
                            </div>

                        <div id="sup-post-2" style="display: inline-block ! important;width: 100%;">
   <p style="text-align:center;"><a href="http://www.zhufengpeixun.cn/?ref=ruanyifeng.com" target="_blank"><img alt="珠峰培训" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/sup_zhufeng_page.png" style="border:none;"></a></p>
   <p style="text-align:center;"><a href="https://cn.udacity.com/ruanyfbanner/" title="优达学城" target="_blank"><img alt="优达学城" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/uda_banner_ryf.jpg" style="border:none;display: block !important;"></a>
</p>                         
  </div>

<div id="related_entries">
<h2>相关文章</h2>
<ul>

<li><strong>2017.04.16: <a href="http://www.ruanyifeng.com/blog/2017/04/memory-leak.html">JavaScript 内存泄漏教程</a></strong>

                           <div class="entry-body">
                              一、什么是内存泄漏？

程序的运行需要内存。只要程序提出要求，操作系统或者运行时（runtime）就必须供给内存。

                           </div>

</li>

 
<li><strong>2017.03.18: <a href="http://www.ruanyifeng.com/blog/2017/03/reduce_transduce.html">Reduce 和 Transduce 的含义</a></strong>

                           <div class="entry-body">
                              学习函数式编程，必须掌握很多术语，否则根本看不懂文档。

                           </div>

</li>

 
<li><strong>2017.03.13: <a href="http://www.ruanyifeng.com/blog/2017/03/pointfree.html">Pointfree 编程风格指南</a></strong>

                           <div class="entry-body">
                              本文要回答一个很重要的问题：函数式编程有什么用？

                           </div>

</li>

 
<li><strong>2017.03.09: <a href="http://www.ruanyifeng.com/blog/2017/03/ramda.html">Ramda 函数库参考教程</a></strong>

                           <div class="entry-body">
                              学习函数式编程的过程中，我接触到了 Ramda.js。

                           </div>

</li>

 
</ul>
</div>


<div id="gd1" style="display: block !important;">
<h2>广告<a href="http://www.ruanyifeng.com/support.html">（购买广告位）</a></h2>
<div id="gd1-inner">
<div id="gd1-left">
<a href="http://www.miaov.com/index.php/news/newsDetail/nid/135?utm_source=ruanyifeng&amp;" alt="妙味课堂" target="_blank"><img alt="妙味课堂" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/sup_miaov_201706.png" style="border:none;display: block !important;"></a>
<br>
<a href="https://fundebug.com/?utm_source=ruanyifeng" title="FunDebug" target="_blank"><img alt="FunDebug" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/fundebug_js_promotion.jpeg" style="border:none;display: block !important;"></a>
</div>
<div id="gd1-right">
<a href="http://trial.ssbit.win/?from=ruanyifeng" title="倚天剑" target="_blank"><img alt="倚天剑" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/ruanyifeng.2k.1forth.banner.png" style="border:none;display: block !important;"></a>
<br>
<a title="BitTiger" href="https://www.bittiger.io/home?utm_source=ruanyifeng&amp;utm_medium=ruanyifeng&amp;utm_content=ruanyifenggeneral" target="_blank"><img alt="BitTiger" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/sup_bittiger_3.jpg" style="border:none;"></a>

</div>
</div>
</div>
                    

                    <div id="comments" class="comments">


    
    
        
    <h2 class="comments-header">留言（114条）</h2>

    <div id="comments-content" class="comments-content" style="clear: left;">
        
        <div id="comment-341027" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.ceclinux.org" href="http://www.ceclinux.org/" target="_blank" rel="nofollow">ceclinux</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341027">
            <p>写的不错</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  8, 2014  9:28 PM">2014年10月 8日 21:28</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341027">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用ceclinux的这条留言" onclick="return CommentQuote(&#39;comment-quote-341027&#39;,&#39;ceclinux&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341028" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://wuwenjie.tk" href="http://wuwenjie.tk/" target="_blank" rel="nofollow">wuwenjie</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341028">
            <p>补充：<a href="http://nodejs.org/api/cluster.html" rel="nofollow">Cluster</a>是node js 多进程的API，是提高js资源使用效率的一种方法。<br>
API描述：A single instance of Node runs in a single thread. To take advantage of multi-core systems the user will sometimes want to launch a cluster of Node processes to handle the load. </p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  8, 2014  9:50 PM">2014年10月 8日 21:50</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341028">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用wuwenjie的这条留言" onclick="return CommentQuote(&#39;comment-quote-341028&#39;,&#39;wuwenjie&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341030" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://wuzhiwei.net" href="http://wuzhiwei.net/" target="_blank" rel="nofollow">Tim</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341030">
            <p>简言之就是JS只有一个主线程，主线程执行完执行栈的任务后去检查异步的任务队列，如果异步事件触发，则将其加到主线程的执行栈。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  8, 2014 10:24 PM">2014年10月 8日 22:24</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341030">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Tim的这条留言" onclick="return CommentQuote(&#39;comment-quote-341030&#39;,&#39;Tim&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341031" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://jruif.github.io" href="http://jruif.github.io/" target="_blank" rel="nofollow">jruif</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341031">
            <p>在https://medium.com/@shijuvar/web-development-trends-for-2015-and-beyond-c2d3c1ef5718这篇文章中的关于nodejs的可维护性、可用性和高性能的论证不知道阮一峰大哥怎么看？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  8, 2014 11:27 PM">2014年10月 8日 23:27</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341031">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用jruif的这条留言" onclick="return CommentQuote(&#39;comment-quote-341031&#39;,&#39;jruif&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341032" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">jare</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341032">
            <p>今天发现#atom-shell#做同步ipc调用时，执行栈是可能被挂起的，相当于主线程sleep了，等ipc返回后才会接着执行后续代码。如果挂起的时候同一段代码被event又一次触发，逻辑就可能出错。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 12:41 AM">2014年10月 9日 00:41</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341032">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用jare的这条留言" onclick="return CommentQuote(&#39;comment-quote-341032&#39;,&#39;jare&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341033" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">jare</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341033">
            <p>也就是说执行栈可能不能在一个loop内被执行完，因为会被挂起，是否挂起取决于运行环境和执行的操作种类。被挂起后前面注册的callback还是有可能先于执行栈剩余的代码触发。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 12:43 AM">2014年10月 9日 00:43</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341033">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用jare的这条留言" onclick="return CommentQuote(&#39;comment-quote-341033&#39;,&#39;jare&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341034" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">rednax</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341034">
            <p>补充一下Timer相关的问题：<br>
1. 其实并不是“有些浏览器规定了setTimeout 的最小时间间隔”，这个最小时间间隔是W3C在HTML标准中规定，规定要求低于4ms的时间间隔算为4ms。<br>
2. process.nextTick在最新版nodejs中不被推荐使用，推荐使用setImmediate ，原因在于nextTick是在当前帧介绍后立即执行，会阻断IO并且有最大数量限制；而setImmediate不会阻断IO，更像是setTimeout(func, 0)</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  1:06 AM">2014年10月 9日 01:06</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341034">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用rednax的这条留言" onclick="return CommentQuote(&#39;comment-quote-341034&#39;,&#39;rednax&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341045" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341045">
            <p>@rednax：</p>

<p>谢谢指出，我还不知道HTML5把4毫秒写入了标准，已经改过来了。</p>

<p>我查了Node.js 10.0的发布说明（ <a href="http://blog.nodejs.org/2013/03/11/node-v0-10-0-stable/" rel="nofollow">http://blog.nodejs.org/2013/03/11/node-v0-10-0-stable/</a> )，对于process和setImmediate的差异，还在消化当中。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  6:31 AM">2014年10月 9日 06:31</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341045">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341045&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341047" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">nimeiz</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341047">
            <p>（3）libuv库负责Node API的执行。它将不同的任务分配给不同的线程，形成一个Event Loop（事件循环），以异步的方式将任务的执行结果返回给V8引擎。<br>
不同任务会分给不同线程？不是直接调用相关操作系统接口？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  8:37 AM">2014年10月 9日 08:37</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341047">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用nimeiz的这条留言" onclick="return CommentQuote(&#39;comment-quote-341047&#39;,&#39;nimeiz&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341048" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">twang</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341048">
            <p>我想转载这篇博客，可以吗？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  9:11 AM">2014年10月 9日 09:11</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341048">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用twang的这条留言" onclick="return CommentQuote(&#39;comment-quote-341048&#39;,&#39;twang&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341050" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://cnn237111.blog.51cto.com/" href="http://cnn237111.blog.51cto.com/" target="_blank" rel="nofollow">roast_soul</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341050">
            <p>我觉得单线程的异步没什么意义。你看一下这个文章：</p>

<p><a href="http://cnn237111.blog.51cto.com/2359144/1556987" rel="nofollow">http://cnn237111.blog.51cto.com/2359144/1556987</a><br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  9:37 AM">2014年10月 9日 09:37</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341050">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用roast_soul的这条留言" onclick="return CommentQuote(&#39;comment-quote-341050&#39;,&#39;roast_soul&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341051" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">万能小新</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341051">
            <p>requestAnimFrame应该是requestAnimationFrame吧。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014  9:39 AM">2014年10月 9日 09:39</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341051">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用万能小新的这条留言" onclick="return CommentQuote(&#39;comment-quote-341051&#39;,&#39;万能小新&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341064" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">chptx</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341064">
            <p>单线程效率高是假，简化开发是真。<br>
跟GUI相关的框架的都采用这种模型，QT、GTK、MFC、Android UI框架、这里的JS都是这样的。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 12:02 PM">2014年10月 9日 12:02</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341064">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用chptx的这条留言" onclick="return CommentQuote(&#39;comment-quote-341064&#39;,&#39;chptx&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341104" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://梁杰.com" href="http://xn--6rvqx.com/" target="_blank" rel="nofollow">numbbbbb</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341104">
            <p>setImmediate的例子有问题吧，触发A之后并不是直接输出1，而是执行另一个setImmediate，这个setImmediate会把B添加到任务队列尾部，在执行B之前会触发setTimeout的回调，所以例子的输出顺序应该是：</p>

<p>// TIMEOUT FIRED<br>
// 1<br>
// 2<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 10:52 PM">2014年10月 9日 22:52</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341104">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用numbbbbb的这条留言" onclick="return CommentQuote(&#39;comment-quote-341104&#39;,&#39;numbbbbb&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341105" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341105">
            <p>@numbbbbb：</p>

<p>谢谢指出，你说得对，例子有错，已经改过来了。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 11:11 PM">2014年10月 9日 23:11</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341105">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341105&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341106" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341106">
            <blockquote>
<pre>引用万能小新的发言：</pre>

<p>requestAnimFrame应该是requestAnimationFrame吧。</p>

</blockquote>

<p>谢谢指出，改过来了。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2014 11:39 PM">2014年10月 9日 23:39</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341106">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341106&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341167" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://suntui.com" href="http://suntui.com/" target="_blank" rel="nofollow">Leo</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341167">
            <p>setImmediate(function A() {<br>
  console.log(1);<br>
  setImmediate(function B(){console.log(2);});<br>
});</p>

<p>setTimeout(function timeout() {<br>
  console.log('TIMEOUT FIRED');<br>
}, 0)<br>
// 1<br>
// TIMEOUT FIRED<br>
// 2<br>
===========<br>
同样的这段代码, 为什么后边的说 Immediate 和 Timeout 的先后顺序不确定呢? 求解释...</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 10, 2014  5:38 PM">2014年10月10日 17:38</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341167">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Leo的这条留言" onclick="return CommentQuote(&#39;comment-quote-341167&#39;,&#39;Leo&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341173" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">mamamiya</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341173">
            <p><a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead" rel="nofollow">https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead</a></p>

<p>朴灵对您文章的评注。语言虽然略显犀利，但是个人觉得评注的应该是对的。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 10, 2014  7:03 PM">2014年10月10日 19:03</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341173">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用mamamiya的这条留言" onclick="return CommentQuote(&#39;comment-quote-341173&#39;,&#39;mamamiya&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341175" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341175">
            <p>@Leo：</p>

<p>谢谢指出，我修改文章时，脑子糊涂了，已经改过来了。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 10, 2014  7:22 PM">2014年10月10日 19:22</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341175">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341175&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341180" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">csu</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341180">
            <p><a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead%E9%98%AE%E8%80%81%E5%B8%88,%E6%9C%89%E4%B8%80%E4%BD%8D%E9%AB%98%E6%89%8B%EF%BC%88%E5%89%8D%E7%AB%AF%E4%B8%93%E5%AE%B6%E6%9C%B4%E7%81%B5%EF%BC%89%E5%AF%B9%E4%BD%A0%E7%9A%84%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E6%8F%90%E5%87%BA%E4%BA%86%E4%B8%8D%E5%B0%91%E7%9C%8B%E6%B3%95%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E7%9C%8B%E7%9C%8B%E3%80%82" rel="nofollow">https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead阮老师,有一位高手（前端专家朴灵）对你的这篇文章提出了不少看法，你可以看看。</a></p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 10, 2014  8:22 PM">2014年10月10日 20:22</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341180">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用csu的这条留言" onclick="return CommentQuote(&#39;comment-quote-341180&#39;,&#39;csu&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341204" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Dean</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341204">
            <p><a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead" rel="nofollow">https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead</a></p>

<p>阮老师 您被打脸了</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 11, 2014  9:32 AM">2014年10月11日 09:32</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341204">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Dean的这条留言" onclick="return CommentQuote(&#39;comment-quote-341204&#39;,&#39;Dean&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341205" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://jjjj" href="http://jjjj/" target="_blank" rel="nofollow">SO</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341205">
            <p>门都还没入就来写科普 </p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 11, 2014  9:39 AM">2014年10月11日 09:39</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341205">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用SO的这条留言" onclick="return CommentQuote(&#39;comment-quote-341205&#39;,&#39;SO&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341221" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://nizhendexinrenwoma.com" href="http://nizhendexinrenwoma.com/" target="_blank" rel="nofollow">BlueiceQ</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341221">
            <p><a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead" rel="nofollow">https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead</a></p>

<p>阮老师，看了没？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 11, 2014 10:51 AM">2014年10月11日 10:51</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341221">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用BlueiceQ的这条留言" onclick="return CommentQuote(&#39;comment-quote-341221&#39;,&#39;BlueiceQ&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341243" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">金戈铁马</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341243">
            <p>打人不打脸，绝交。。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 11, 2014  2:50 PM">2014年10月11日 14:50</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341243">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用金戈铁马的这条留言" onclick="return CommentQuote(&#39;comment-quote-341243&#39;,&#39;金戈铁马&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341294" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">rednax</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341294">
            <blockquote>
<pre>引用mamamiya的发言：</pre>

<p><a href="https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead" rel="nofollow">https://app.yinxiang.com/shard/s8/sh/b72fe246-a89d-434b-85f0-a36420849b84/59bad790bdcf6b0a66b8b93d5eacbead</a></p>

<p>朴灵对您文章的评注。语言虽然略显犀利，但是个人觉得评注的应该是对的。</p>

</blockquote>
看了一下不觉得评注对到哪里去，只有吹毛求疵之感。
比如同步异步介绍，本来就无大错；比如node图里面的OS operation，推敲一下就可以猜到那是指同步操作（自然不走event loop了）；至于watcher啥的，显然只是实现上的特色，即使用同一个queue实现也未尝不可。
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014  4:39 PM">2014年10月12日 16:39</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341294">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用rednax的这条留言" onclick="return CommentQuote(&#39;comment-quote-341294&#39;,&#39;rednax&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341300" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">zzm</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341300">
            <p>我去，被朴灵狠劈，现在更乱了</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014  7:48 PM">2014年10月12日 19:48</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341300">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用zzm的这条留言" onclick="return CommentQuote(&#39;comment-quote-341300&#39;,&#39;zzm&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341302" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">牛牛</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341302">
            <p>请问你一个问题，你的主业是金融，为什么还花这么多时间在编程上？即使你明知道不管你如何努力地来提高自己的编程水平，也无法改变业余的地位，也得不到什么实际的回报。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014  8:03 PM">2014年10月12日 20:03</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341302">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用牛牛的这条留言" onclick="return CommentQuote(&#39;comment-quote-341302&#39;,&#39;牛牛&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341304" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">zzm</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341304">
            <blockquote>
<pre>引用rednax的发言：</pre>

<p><br>
看了一下不觉得评注对到哪里去，只有吹毛求疵之感。<br>
比如同步异步介绍，本来就无大错；比如node图里面的OS operation，推敲一下就可以猜到那是指同步操作（自然不走event loop了）；至于watcher啥的，显然只是实现上的特色，即使用同一个queue实现也未尝不可。</p>

</blockquote>

<p>多看几眼还真是</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014  8:09 PM">2014年10月12日 20:09</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341304">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用zzm的这条留言" onclick="return CommentQuote(&#39;comment-quote-341304&#39;,&#39;zzm&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341312" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://github.com/hustxiaoc/" href="https://github.com/hustxiaoc/" target="_blank" rel="nofollow">淘杰</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341312">
            <p>"setImmediate的另一个重要特点：一次"事件循环"只能触发一个由setImmediate指定的回调函数。"<br>
这个说法其实也不准确，准确的说是因为setImmediate是在事件循环结束后触发，</p>

<p>setImmediate(function A() {<br>
    console.log(1);<br>
    setImmediate(function B(){console.log(2);});<br>
 });</p>

<p> setTimeout(function timeout() {<br>
    console.log('TIMEOUT FIRED');<br>
  }, 0);<br>
当第一个loop结束后触发第一次setImmediate，此时setImmediate调用之后开始将回调函数加入队列等待下一个loop结束触发, 而不是一次"事件循环"只能触发一个由setImmediate指定的回调函数。多个只要在loop前已经执行掉同样会在一次"事件循环"中一起触发。<br>
setImmediate(function A() {<br>
    console.log(1);<br>
 });<br>
setImmediate(function B(){console.log(2);});<br>
实际上，上面调用2次setImmediate会形成一个immediateQueue链表，loop结束后会执行改链表里所有的函数～<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014 10:47 PM">2014年10月12日 22:47</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341312">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用淘杰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341312&#39;,&#39;淘杰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341313" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://github.com/hustxiaoc/" href="https://github.com/hustxiaoc/" target="_blank" rel="nofollow">淘杰</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341313">
            <blockquote>
<pre>引用Leo的发言：</pre>

<p>setImmediate(function A() {<br>
console.log(1);<br>
setImmediate(function B(){console.log(2);});<br>
});</p>

<p>setTimeout(function timeout() {<br>
console.log('TIMEOUT FIRED');<br>
}, 0)<br>
// 1<br>
// TIMEOUT FIRED<br>
// 2<br>
===========<br>
同样的这段代码, 为什么后边的说 setImmediate 和 Timeout 的先后顺序不确定呢? 求解释...</p>

</blockquote>

<p>@Leo , node中的底层loop有3种运行模式，DEFAULT, UV_RUN_ONCE,UV_RUN_NOWAIT具体差异详见libuv文档 。 刚启动node解析执行脚本时以UV_RUN_ONCE的模式执行也就是说第一次loop是UV_RUN_ONCE模式，在每一个loop中先检测timers，然后进入io_poll此时会阻塞等待事件发生，事件发生后执行setImmediate中的回调，当以UV_RUN_ONCE模式执行的时候会再次检测timers 。照这个原理来说，setImmediate应该比setTimeout先执行。</p>

<p> setTimeout(fn,0) 底层实际执行的是 setTimeout(fn,1), 此时会向loop队列中注册一个超时事件，假设注册时当前时间戳是1000，它的过期时间就是1001。按上面的说法1ms 第一次loop执行完后先执行setImmediate回调，再执行timer回调。但是有一点别忘了，您的计算机此时还有其他任务在处理，cpu不是全部用来跑你的node进程的，也就是说虽然cpu很快，但执行指令总得花点时间吧，从setTimeout(fn,0)注册一个1ms的超时事件到第一次执行timers可能就已经花了1ms的时间，此时系统时间已经到1001了，那么对应的timer回调当然就会先于setImmediate执行，所以说Immediate 和 Timeout 的先后顺序不确定。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 12, 2014 11:08 PM">2014年10月12日 23:08</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341313">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用淘杰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341313&#39;,&#39;淘杰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341334" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341334">
            <blockquote>
<pre>引用淘杰的发言：</pre>

<p>当第一个loop结束后触发第一次setImmediate，此时setImmediate调用之后开始将回调函数加入队列等待下一个loop结束触发, 而不是一次"事件循环"只能触发一个由setImmediate指定的回调函数。多个只要在loop前已经执行掉同样会在一次"事件循环"中一起触发。<br>
</p></blockquote>

<p>谢谢指出，确实如此，已经改正了。<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  9:11 AM">2014年10月13日 09:11</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341334">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341334&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341336" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">crazy</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341336">
            <p>究竟谁对谁错呢？现在有些混乱了</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  9:31 AM">2014年10月13日 09:31</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341336">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用crazy的这条留言" onclick="return CommentQuote(&#39;comment-quote-341336&#39;,&#39;crazy&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341337" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Jak Wings</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341337">
            <blockquote>
<pre>引用crazy的发言：</pre>

<p>究竟谁对谁错呢？现在有些混乱了</p>

</blockquote>

<p>普通应用没必要这么吹毛球疵，只要了解一下 process.nextTick 和 setImmediate 的区别就好了，官方的 API 说明已经解释得很好，带实际应用示例。阮先生没有把官方介绍的 process.nextTick 实际用例放上来直接硬剥是有点无趣了。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  9:39 AM">2014年10月13日 09:39</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341337">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jak Wings的这条留言" onclick="return CommentQuote(&#39;comment-quote-341337&#39;,&#39;Jak Wings&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341338" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Jak Wings</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341338">
            <blockquote>
我们由此得到了process.nextTick和setImmediate的一个重要区别……事实上，这正是Node.js 10.0版添加setImmediate方法的原因，否则像下面这样的递归调用process.nextTick，将会没完没了……
</blockquote>

<p>不知道哪里来的「事实上」，官方示例已经明确地说「This is not a simple alias to setTimeout(fn, 0)」了，当然也更不可能原本作为 setImmediate 的替代，或者反过来。process.nextTick 是有特殊用途的，并还是单单脱离原有的 event loop。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  9:46 AM">2014年10月13日 09:46</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341338">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jak Wings的这条留言" onclick="return CommentQuote(&#39;comment-quote-341338&#39;,&#39;Jak Wings&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341340" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Jak Wings</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341340">
            <blockquote>
<pre>引用Jak Wings的发言：</pre>

<p></p>

<p>不知道哪里来的「事实上」，官方示例已经明确地说「This is not a simple alias to setTimeout(fn, 0)」了，当然也更不可能原本作为 setImmediate 的替代，或者反过来。process.nextTick 是有特殊用途的，并还是单单脱离原有的 event loop。</p>

</blockquote>

<p>囧，抱歉，才看了官方发布说明，看来 process.nextTick 是被滥用后才加上 setImmediate 的。不过我还是觉得 API 说明页面的说明比发布那时的好，setImmediate 是和 setTimeout 使用同一个 event loop 的，应该凸出了和 process.nextTick 的不同了，应该也是后来提防大家滥用才这么设定的。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  9:56 AM">2014年10月13日 09:56</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341340">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jak Wings的这条留言" onclick="return CommentQuote(&#39;comment-quote-341340&#39;,&#39;Jak Wings&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341344" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Jak Wings</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341344">
            <blockquote>
令人困惑的是，Node.js文档中称，setImmediate指定的回调函数，总是排在setTimeout前面。实际上，这种情况只发生在递归调用的时候。
</blockquote>

<p>我刚刚用 v0.10.32 和 v0.11.14测试过了，这个也没有保证。我能得到 1-T...-2 和 1-2-T... 两种结果，甚至是 T...-1-2。信不信由你。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014 10:14 AM">2014年10月13日 10:14</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341344">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jak Wings的这条留言" onclick="return CommentQuote(&#39;comment-quote-341344&#39;,&#39;Jak Wings&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341358" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341358">
            <blockquote>
<pre>引用Jak Wings的发言：</pre>

<p><br>
我刚刚用 v0.10.32 和 v0.11.14测试过了，这个也没有保证。我能得到 1-T...-2 和 1-2-T... 两种结果，甚至是 T...-1-2。信不信由你。</p>

</blockquote>

<p>我测的结果，一直都是1-T-2。难道这个也不确定…… </p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  2:06 PM">2014年10月13日 14:06</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341358">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341358&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341367" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://suntui.com" href="http://suntui.com/" target="_blank" rel="nofollow">Leo</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341367">
            <p>@淘杰：</p>

<p>谢谢解释~</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 13, 2014  2:44 PM">2014年10月13日 14:44</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341367">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Leo的这条留言" onclick="return CommentQuote(&#39;comment-quote-341367&#39;,&#39;Leo&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341435" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://zmx.im" href="http://zmx.im/" target="_blank" rel="nofollow">林夕轩</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341435">
            <blockquote>
<pre>引用淘杰的发言：</pre>

<p> setTimeout(fn,0) 底层实际执行的是 setTimeout(fn,1), 此时会向loop队列中注册一个超时事件，假设注册时当前时间戳是1000，它的过期时间就是1001。按上面的说法1ms 第一次loop执行完后先执行setImmediate回调，再执行timer回调。但是有一点别忘了，您的计算机此时还有其他任务在处理，cpu不是全部用来跑你的node进程的，也就是说虽然cpu很快，但执行指令总得花点时间吧，从setTimeout(fn,0)注册一个1ms的超时事件到第一次执行timers可能就已经花了1ms的时间，此时系统时间已经到1001了，那么对应的timer回调当然就会先于setImmediate执行，所以说Immediate 和 Timeout 的先后顺序不确定。</p>

</blockquote>

<p>这么解释的确合理，定时器的原理都是如此，告诉cpu有个任务在某个时间应该执行。但也只有cpu有空的时候，才能尽快执行才可。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 14, 2014 11:10 AM">2014年10月14日 11:10</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341435">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用林夕轩的这条留言" onclick="return CommentQuote(&#39;comment-quote-341435&#39;,&#39;林夕轩&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341458" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">猴子</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341458">
            <p>读完正文觉得很多东西是纯理论的理解，有些可能来源于猜测。</p>

<p>这篇文章更该是一个学习笔记，文中提到的很多event其实和Javascript语言完全无关，纯粹是浏览器的处理和行为。</p>

<p>对于任何一个不基于浏览器且支持多线程的程序来讲（比如随便一个C实现的游戏），会发现同样的事件处理比如鼠标操作、键盘快捷键等等，是需要去自己单独实现的，那么也许实现中使用了Event loop，但这一部分从未集成到语言中，对吧？</p>

<p>理解这个事情更好的办法是真的去实现一个类似的程序。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 14, 2014  4:37 PM">2014年10月14日 16:37</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341458">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用猴子的这条留言" onclick="return CommentQuote(&#39;comment-quote-341458&#39;,&#39;猴子&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341571" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://chenjia.info" href="http://chenjia.info/" target="_blank" rel="nofollow">陈佳</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341571">
            <p>看来我需要买书好好学学了。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 16, 2014  1:51 AM">2014年10月16日 01:51</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341571">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用陈佳的这条留言" onclick="return CommentQuote(&#39;comment-quote-341571&#39;,&#39;陈佳&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341620" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Jak Wings</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341620">
            <blockquote>
<pre>引用阮一峰的发言：</pre>

<p></p>

<p>我测的结果，一直都是1-T-2。难道这个也不确定…… </p>

</blockquote>

<p>对了，V8 引擎能代表所有实现了 ES6 的浏览器的具体实现么？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 16, 2014  3:09 PM">2014年10月16日 15:09</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341620">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jak Wings的这条留言" onclick="return CommentQuote(&#39;comment-quote-341620&#39;,&#39;Jak Wings&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341629" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">阮一峰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341629">
            <blockquote>
<pre>引用Jak Wings的发言：</pre>

<p>V8 引擎能代表所有实现了 ES6 的浏览器的具体实现么？</p>

</blockquote>

<p>问题是Node采用了V8</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 16, 2014  5:33 PM">2014年10月16日 17:33</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341629">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用阮一峰的这条留言" onclick="return CommentQuote(&#39;comment-quote-341629&#39;,&#39;阮一峰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341630" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://stackvoid.com" href="http://stackvoid.com/" target="_blank" rel="nofollow">stackvoid</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341630">
            <p>的确有些说法不太严谨~~~</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 16, 2014  5:36 PM">2014年10月16日 17:36</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341630">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用stackvoid的这条留言" onclick="return CommentQuote(&#39;comment-quote-341630&#39;,&#39;stackvoid&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341746" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">爱因斯坦</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341746">
            <blockquote>
<pre>引用牛牛的发言：</pre>

<p>请问你一个问题，你的主业是金融，为什么还花这么多时间在编程上？即使你明知道不管你如何努力地来提高自己的编程水平，也无法改变业余的地位，也得不到什么实际的回报。</p>

</blockquote>

<p>请问你一个问题，你的主业是专利局小职员，为什么还花这么多时间在物理上？即使你明知道不管你如何努力地来提高自己的数学水平，也无法改变业余的地位，也得不到什么实际的回报。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 18, 2014  3:45 AM">2014年10月18日 03:45</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341746">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用爱因斯坦的这条留言" onclick="return CommentQuote(&#39;comment-quote-341746&#39;,&#39;爱因斯坦&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341784" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.huzhiming.net" href="http://www.huzhiming.net/" target="_blank" rel="nofollow">朴素博客</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341784">
            <blockquote>
<pre>引用爱因斯坦的发言：</pre>

<p></p>

<p>请问你一个问题，你的主业是专利局小职员，为什么还花这么多时间在物理上？即使你明知道不管你如何努力地来提高自己的数学水平，也无法改变业余的地位，也得不到什么实际的回报。</p>

</blockquote>因为热爱 所以热爱
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 18, 2014  5:18 PM">2014年10月18日 17:18</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341784">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用朴素博客的这条留言" onclick="return CommentQuote(&#39;comment-quote-341784&#39;,&#39;朴素博客&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341917" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">腊月乘凉</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341917">
            <p>阮大侠你就别再祸害程序员了，建议先补一下计算机组成原理，编译原理，算法导论，C语言基础再来出书，不然你出了也没人敢看吧。另外起码要实践一点儿项目。</p>

<p>    var req = new XMLHttpRequest();<br>
    req.open('GET', url);    <br>
    req.onload = function (){};    <br>
    req.onerror = function (){};    <br>
    req.send();</p>

<p>var req = new XMLHttpRequest();<br>
    req.open('GET', url);<br>
    req.send();<br>
    req.onload = function (){};    <br>
    req.onerror = function (){}; <br>
 <br>
你说这俩等价，等价个毛线啊，req.send();之后如果浏览器有缓存这个函数会立即返回，也就是说不管你是onload还是onerror都不会执行。要先绑定回调再去执行send()，这样才没bug。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 22, 2014 12:09 AM">2014年10月22日 00:09</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341917">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用腊月乘凉的这条留言" onclick="return CommentQuote(&#39;comment-quote-341917&#39;,&#39;腊月乘凉&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-341969" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">jiangjunzhangas</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-341969">
            <p>不过瘾</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 22, 2014 10:02 PM">2014年10月22日 22:02</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-341969">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用jiangjunzhangas的这条留言" onclick="return CommentQuote(&#39;comment-quote-341969&#39;,&#39;jiangjunzhangas&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342243" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.veryarm.com/" href="http://www.veryarm.com/" target="_blank" rel="nofollow">ARM Linux</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342243">
            <p>Js原来还有这么深奥的功能</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 28, 2014  1:53 PM">2014年10月28日 13:53</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342243">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用ARM Linux的这条留言" onclick="return CommentQuote(&#39;comment-quote-342243&#39;,&#39;ARM Linux&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342340" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://wumengyuan.com" href="http://wumengyuan.com/" target="_blank" rel="nofollow">小雪</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342340">
            <blockquote>
<pre>引用牛牛的发言：</pre>

<p>请问你一个问题，你的主业是金融，为什么还花这么多时间在编程上？即使你明知道不管你如何努力地来提高自己的编程水平，也无法改变业余的地位，也得不到什么实际的回报。</p>

</blockquote>

<p>阮老师已经是程序员了……</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 30, 2014  7:38 PM">2014年10月30日 19:38</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342340">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用小雪的这条留言" onclick="return CommentQuote(&#39;comment-quote-342340&#39;,&#39;小雪&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342374" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Hiccup</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342374">
            <p>不正确的文章为什么不删掉</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 31, 2014 11:54 AM">2014年10月31日 11:54</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342374">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Hiccup的这条留言" onclick="return CommentQuote(&#39;comment-quote-342374&#39;,&#39;Hiccup&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342376" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">reducm</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342376">
            <p>想不到阮老师去了阿里巴巴做前端阿</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 31, 2014  1:53 PM">2014年10月31日 13:53</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342376">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用reducm的这条留言" onclick="return CommentQuote(&#39;comment-quote-342376&#39;,&#39;reducm&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342378" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">渠德通</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342378">
            <p>很长一段时间，google日历无法访问，但网上又找不到好用的在线日历软件，偶然间看到您开发的这个简易版google日历，发自内心的高兴，但所有的浏览器都用了，就是无法联接，联的过程中，显示一个进度条，等到100%之后，马上出现一个空白页，提示无法连接。郁闷中！！  如果才能正常联接，期待您的指点。我的邮箱为：qudetong@www5a.com,手机：13501282988.如果可能能话，我愿意为您长期进行测试各项功能</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 31, 2014  3:10 PM">2014年10月31日 15:10</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342378">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用渠德通的这条留言" onclick="return CommentQuote(&#39;comment-quote-342378&#39;,&#39;渠德通&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342385" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">alex</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342385">
            <p>欢迎兔哥加入大阿里！</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 31, 2014  9:38 PM">2014年10月31日 21:38</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342385">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用alex的这条留言" onclick="return CommentQuote(&#39;comment-quote-342385&#39;,&#39;alex&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342469" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://无" href="http://xn--rgv/" target="_blank" rel="nofollow">陈明</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342469">
            <p>强烈建议博主开个微信公众号！</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  2, 2014  9:30 AM">2014年11月 2日 09:30</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342469">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用陈明的这条留言" onclick="return CommentQuote(&#39;comment-quote-342469&#39;,&#39;陈明&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342497" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://jiabin.tk" href="http://jiabin.tk/" target="_blank" rel="nofollow">Byron</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342497">
            <blockquote>
<pre>引用reducm的发言：</pre>

<p>想不到阮老师去了阿里巴巴做前端阿</p>

</blockquote>

<p>是为了和朴灵PK才来的么？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  3, 2014 10:20 AM">2014年11月 3日 10:20</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342497">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Byron的这条留言" onclick="return CommentQuote(&#39;comment-quote-342497&#39;,&#39;Byron&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342510" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">花生大仙</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342510">
            <p>好久没更新博客了，甚是想念。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  3, 2014  2:01 PM">2014年11月 3日 14:01</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342510">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用花生大仙的这条留言" onclick="return CommentQuote(&#39;comment-quote-342510&#39;,&#39;花生大仙&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-342723" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">赵秀芳</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-342723">
            <p>听说阮先生，要去蚂蚁金服了...<br>
阮先生好久不更新了，要记得常常更新哦。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  6, 2014 11:05 AM">2014年11月 6日 11:05</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-342723">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用赵秀芳的这条留言" onclick="return CommentQuote(&#39;comment-quote-342723&#39;,&#39;赵秀芳&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-343226" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Steven</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-343226">
            <p>@腊月乘凉：</p>

<p>确实是这样的</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 11, 2014 12:14 AM">2014年11月11日 00:14</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-343226">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Steven的这条留言" onclick="return CommentQuote(&#39;comment-quote-343226&#39;,&#39;Steven&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-344801" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">雁南飞</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-344801">
            <p>有没有办法查看Function Object的internal property？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 25, 2014 11:45 AM">2014年11月25日 11:45</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-344801">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用雁南飞的这条留言" onclick="return CommentQuote(&#39;comment-quote-344801&#39;,&#39;雁南飞&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-344803" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">felix</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-344803">
            <p>有一个问题，事件执行的粒度是多大？是一个函数还是一个语句块？<br>
在大量的异步方法同时操作一个变量的时候，会不会出现类似线程的问题呢？<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 25, 2014 11:57 AM">2014年11月25日 11:57</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-344803">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用felix的这条留言" onclick="return CommentQuote(&#39;comment-quote-344803&#39;,&#39;felix&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-344854" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.cnblogs.com/yuanzm" href="http://www.cnblogs.com/yuanzm" target="_blank" rel="nofollow">袁梓民</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-344854">
            <p>var start = new Date();<br>
console.log(start);</p>

<p>var print = setTimeout(function() {<br>
	var end = new Date();<br>
	console.log('从开始到执行这个setTimeout函数花掉的时间为', end - start, "ms");<br>
}, 1000);</p>

<p>var test = [];<br>
for(var i = 0; i 
	test.push(i);<br>
}<br>
var middle = new Date();<br>
console.log('执行数组操作所花掉的时间为：',middle - start, 'ms');</p>

<p>我想请教一下这里的setTimeout会在什么时候执行？我再node里面和浏览器里面分别跑了几次。得到的结果是：<br>
node：<br>
执行数组操作所花掉的时间为： 379 ms<br>
从开始到执行这个setTimeout函数花掉的时间为： 1030ms<br>
按照您的说法，setTimeout应该是尽可能在能执行的时候执行，这里运算操作只是379ms，没有超过初始设定的1000ms，按道理1030ms不应该是1001ms么？<br>
浏览器：<br>
执行数组操作所花掉的时间为： 8016 ms<br>
从开始到执行这个setTimeout函数花掉的时间为 8017 ms<br>
这个结果中，运算时间很长，远远超过了1000ms，所以setTimeout不是在1001ms执行的，而是等到元算结束之后立即执行，那么结果奇怪了，这个setTimeout时间设定成1000ms是从什么时候开始的？我的理解是一开始就计时，但是1000ms无法执行，等到数组操作完成之后才能执行，这样计时操作似乎没有存在的意义了。<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 26, 2014  2:14 PM">2014年11月26日 14:14</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-344854">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用袁梓民的这条留言" onclick="return CommentQuote(&#39;comment-quote-344854&#39;,&#39;袁梓民&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-345375" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">stubbornleaf</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-345375">
            <p>原来水平也不过如此。有点水平的人都看得懂朴灵的批注比较准确。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December  2, 2014  7:13 AM">2014年12月 2日 07:13</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-345375">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用stubbornleaf的这条留言" onclick="return CommentQuote(&#39;comment-quote-345375&#39;,&#39;stubbornleaf&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-346175" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">rufushuang</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-346175">
            <p>从这篇文章看得出，阮老师不是科班出身的<br>
不过非科班的也有非科班的好，希望能够继续有文章看</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 11, 2014  2:52 PM">2014年12月11日 14:52</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-346175">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用rufushuang的这条留言" onclick="return CommentQuote(&#39;comment-quote-346175&#39;,&#39;rufushuang&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-346401" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">水中月镜中花</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-346401">
            <p>阮老师，那如果在ajax的回调函数中，存在setTimeOut函数，这个时候回调函数中还是按照Event loop的机制吗？就是说回调函数相当于主线程，把setTimeOut函数放在任务对象，先执行回调函数的代码再执行执行setTimeout函数？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 17, 2014  2:59 PM">2014年12月17日 14:59</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-346401">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用水中月镜中花的这条留言" onclick="return CommentQuote(&#39;comment-quote-346401&#39;,&#39;水中月镜中花&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-347526" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">欧文</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-347526">
            <p>阮老师，你的站点统计工具：specificclick好像不工作耶，请须知。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="January 26, 2015  2:28 PM">2015年1月26日 14:28</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-347526">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用欧文的这条留言" onclick="return CommentQuote(&#39;comment-quote-347526&#39;,&#39;欧文&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-347594" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">linda</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-347594">
            <p>对您的网站有一些小提议，供您参考。<br>
1、给页面右下角或者右侧加一个按钮，可以直接跳到最顶层，这样对读者来说很方便，因为一直拖动滚动条很麻烦。同时，这个按钮相对于浏览器窗口是固定的。<br>
2、给标题下面加上您文章的写作日期。作为读者我感觉这个时间挺重要的。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="January 28, 2015  3:43 PM">2015年1月28日 15:43</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-347594">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用linda的这条留言" onclick="return CommentQuote(&#39;comment-quote-347594&#39;,&#39;linda&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-347911" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.keepgouing.com" href="http://www.keepgouing.com/" target="_blank" rel="nofollow">Taomax</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-347911">
            <p>嗯，还是比较实用的内容呢，我会长期关注的。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="February  5, 2015  8:48 PM">2015年2月 5日 20:48</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-347911">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Taomax的这条留言" onclick="return CommentQuote(&#39;comment-quote-347911&#39;,&#39;Taomax&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348416" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">stupid</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348416">
            <p>请不要说你在淘宝工作好吗？淘宝不都是大牛吗？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 10, 2015 11:22 AM">2015年3月10日 11:22</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348416">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用stupid的这条留言" onclick="return CommentQuote(&#39;comment-quote-348416&#39;,&#39;stupid&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348417" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">stupid</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348417">
            <p>淘宝的人都喜欢出书吗？竟然都敢出书？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 10, 2015 11:24 AM">2015年3月10日 11:24</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348417">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用stupid的这条留言" onclick="return CommentQuote(&#39;comment-quote-348417&#39;,&#39;stupid&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348866" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://github.com/1024bit" href="http://github.com/1024bit" target="_blank" rel="nofollow">1024bit</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348866">
            <blockquote>
<pre>引用腊月乘凉的发言：</pre>

<p>阮大侠你就别再祸害程序员了，建议先补一下计算机组成原理，编译原理，算法导论，C语言基础再来出书，不然你出了也没人敢看吧。另外起码要实践一点儿项目。</p>

<p>var req = new XMLHttpRequest();<br>
req.open('GET', url);<br>
req.onload = function (){};<br>
req.onerror = function (){};<br>
req.send();</p>

<p>var req = new XMLHttpRequest();<br>
req.open('GET', url);<br>
req.send();<br>
req.onload = function (){};<br>
req.onerror = function (){}; <br>
 <br>
你说这俩等价，等价个毛线啊，req.send();之后如果浏览器有缓存这个函数会立即返回，也就是说不管你是onload还是onerror都不会执行。要先绑定回调再去执行send()，这样才没bug。</p>

</blockquote>

<p>擦，能不能不要绑定宿主环境。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 31, 2015  5:16 PM">2015年3月31日 17:16</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348866">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用1024bit的这条留言" onclick="return CommentQuote(&#39;comment-quote-348866&#39;,&#39;1024bit&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348932" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">简陋的以数据</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348932">
            <p>感觉文章的表述有些乱，比如“不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。”，这句让人理解的意思是“任务队列”主动通知“主线程”。而后面所表达的却是“主线程”在执行栈清空后才会到任务队列中取任务。前后主被动关系矛盾啊。</p>

<p>还有，“（2）主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。”。这时异步任务还在队列里没执行呢，怎么就会有了运行结果呢？</p>

<p>烦请阮老师在方便的时候不吝赐教。同时，感谢阮老师每次耐心细致的讲解和分享！</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April  5, 2015 11:28 AM">2015年4月 5日 11:28</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348932">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用简陋的以数据的这条留言" onclick="return CommentQuote(&#39;comment-quote-348932&#39;,&#39;简陋的以数据&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348958" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">oceanstick</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348958">
            <p>定时器执行流程还是没讲清楚。。。。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April  7, 2015  7:49 PM">2015年4月 7日 19:49</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348958">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用oceanstick的这条留言" onclick="return CommentQuote(&#39;comment-quote-348958&#39;,&#39;oceanstick&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-348974" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">timdus</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-348974">
            <p> 能说说这个网站是怎么建 的么</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April  9, 2015  1:44 AM">2015年4月 9日 01:44</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-348974">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用timdus的这条留言" onclick="return CommentQuote(&#39;comment-quote-348974&#39;,&#39;timdus&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-350609" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">云霄</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-350609">
            <p>不管扑灵和你都写的云里雾里的。。。不透彻。。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="July  6, 2015  8:05 PM">2015年7月 6日 20:05</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-350609">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用云霄的这条留言" onclick="return CommentQuote(&#39;comment-quote-350609&#39;,&#39;云霄&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-350767" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">青苔</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-350767">
            <p>老师你好，请教个问题，如果是如图示Execution Context Stack所展示的那样，岂不是后来的Context先执行？<br>
那为何<br>
console.log('a');<br>
console.log('b');<br>
可以得到我们所要的执行顺序呢？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="July 12, 2015  4:28 PM">2015年7月12日 16:28</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-350767">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用青苔的这条留言" onclick="return CommentQuote(&#39;comment-quote-350767&#39;,&#39;青苔&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-351430" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">andy</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-351430">
            <pre>上面代码中，setImmediate和setTimeout被封装在一个setImmediate里面，它的运行结果总是1--TIMEOUT FIRED--2，这时函数A一定在timeout前面触发。</pre>

<p>结果不总是1--TIMEOUT FIRED--2 还可能是TIMEOUT--1--2。</p>

<p>node 版本v0.12.2 windows 64位系统</p>

<p><br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="August 25, 2015  5:43 PM">2015年8月25日 17:43</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-351430">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用andy的这条留言" onclick="return CommentQuote(&#39;comment-quote-351430&#39;,&#39;andy&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-351578" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://manxisuo.cnblogs.com" href="http://manxisuo.cnblogs.com/" target="_blank" rel="nofollow">manxisuo</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-351578">
            <p>@腊月乘凉：</p>

<p>的确，这个地方阮老师的说法是不对的。两者并不等价。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="September  6, 2015  1:45 PM">2015年9月 6日 13:45</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-351578">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用manxisuo的这条留言" onclick="return CommentQuote(&#39;comment-quote-351578&#39;,&#39;manxisuo&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-351685" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://manxisuo.cnblogs.com" href="http://manxisuo.cnblogs.com/" target="_blank" rel="nofollow">manxisuo</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-351685">
            <p>给大家推荐一篇，把Event Loop讲得非常清楚的文章：<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop" rel="nofollow">https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop</a><br>
中文：<br>
<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/EventLoop" rel="nofollow">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/EventLoop</a></p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="September 14, 2015  1:56 PM">2015年9月14日 13:56</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-351685">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用manxisuo的这条留言" onclick="return CommentQuote(&#39;comment-quote-351685&#39;,&#39;manxisuo&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-351826" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">harole</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-351826">
            <p>问题图片丢失。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="September 23, 2015 10:20 AM">2015年9月23日 10:20</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-351826">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用harole的这条留言" onclick="return CommentQuote(&#39;comment-quote-351826&#39;,&#39;harole&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-351873" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">shzle</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-351873">
            <p>执行栈（execution context stack）清空的时机是什么？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="September 26, 2015 12:30 PM">2015年9月26日 12:30</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-351873">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用shzle的这条留言" onclick="return CommentQuote(&#39;comment-quote-351873&#39;,&#39;shzle&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-352053" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">kirito</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-352053">
            <blockquote>
<pre>引用简陋的以数据的发言：</pre>

<p>感觉文章的表述有些乱，比如“不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。”，这句让人理解的意思是“任务队列”主动通知“主线程”。而后面所表达的却是“主线程”在执行栈清空后才会到任务队列中取任务。前后主被动关系矛盾啊。</p>

<p>还有，“（2）主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。”。这时异步任务还在队列里没执行呢，怎么就会有了运行结果呢？</p>

<p>烦请阮老师在方便的时候不吝赐教。同时，感谢阮老师每次耐心细致的讲解和分享！</p>

</blockquote>

<p>同惑啊，“异步任务有了运行结果，就在'任务队列'之中放置一个事件”，这句不大理解呢，文中不是说同步任务清空之后才执行任务队列的么？前面这个异步的结果是哪里的？求解~~</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October  9, 2015  3:17 PM">2015年10月 9日 15:17</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-352053">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用kirito的这条留言" onclick="return CommentQuote(&#39;comment-quote-352053&#39;,&#39;kirito&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-352202" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">夏爽</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-352202">
            <p>window.onload = function(){</p>

<p>   document.onmousedown  = function(){<br>
	var oInput = document.createElement("input");<br>
	oInput.value = "输入内容";<br>
	document.body.appendChild(oInput);<br>
	oInput.focus();<br>
	oInput.select();	<br>
   }<br>
}</p>

<p>为什么把onmousedowm换成onclick在ie与chrome下显示效果不同</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 17, 2015  9:40 PM">2015年10月17日 21:40</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-352202">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用夏爽的这条留言" onclick="return CommentQuote(&#39;comment-quote-352202&#39;,&#39;夏爽&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-352666" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">fans</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-352666">
            <p>大神我有个问题，如何判断主线程结束，可以进入队列。什么时候能第二次进入主线程。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  8, 2015  9:44 PM">2015年11月 8日 21:44</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-352666">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用fans的这条留言" onclick="return CommentQuote(&#39;comment-quote-352666&#39;,&#39;fans&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-353099" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">alex 杰</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-353099">
            <p>技术学术自然有需要严谨的地方，老师自然不可能触类旁引，将各个面都涉及的东西讲透，所以有些语言带过，也有确实考虑不周的地方。同样是做技术的，我觉有人跟进技术潮流，出来讲就很好了，至少人家在治学，敢于发表，听取意见。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December  5, 2015  2:40 PM">2015年12月 5日 14:40</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-353099">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用alex 杰的这条留言" onclick="return CommentQuote(&#39;comment-quote-353099&#39;,&#39;alex 杰&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-353480" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Lion</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-353480">
            <p>文中提到 “如果将setTimeout()的第二个参数设为0，就表示当前代码执行完（执行栈清空）以后，立即执行（0毫秒间隔）指定的回调函数。”，<br>
提到“setImmediate方法则是在当前"任务队列"的尾部添加事件”，<br>
又提到“Node.js文档中称，setImmediate指定的回调函数，总是排在setTimeout前面”。</p>

<p>这三块东西逻辑矛盾了，肯定有谁出错了，求指点。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 23, 2015  4:13 PM">2015年12月23日 16:13</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-353480">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Lion的这条留言" onclick="return CommentQuote(&#39;comment-quote-353480&#39;,&#39;Lion&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-353672" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">tom</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-353672">
            <p>所有windows平台的软件都基于消息队列循环方式。浏览器只是普通的windows本地程序，和winform,mfc等都是同样的机制</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 31, 2015  2:16 PM">2015年12月31日 14:16</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-353672">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用tom的这条留言" onclick="return CommentQuote(&#39;comment-quote-353672&#39;,&#39;tom&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-353700" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">just coding</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-353700">
            <p>读了3遍，还是有一些不太理解的地方。<br>
比如：同步任务执行完毕之后，才会去执行异步任务。<br>
那会不会出现这样一种情况，a,b,c,d,e是同步任务。1,2,3是异步任务。<br>
当a,b,c,d,e 执行完毕之后，主线程立马就去将异步任务1,2,3全部读入执行栈，还是按顺序只读取第一个？<br>
那如果，a,b,c,d,e执行完毕之后，会不会在某种情况下，c又要重新执行一次？那此时的c算同步任务还是异步任务？<br>
还有，到底何种任务叫同步任务，何种任务又要异步任务？<br>
我初浅的理解是：一般浏览器的默认执行行为，比如 dom加载，css渲染之类的都叫同步任务。<br>
click,onload之类的都叫异步任务。<br>
理由是：前者在浏览器整个生命周期中，都算一种比较固定的步骤，每一次都要执行。且绝大多数任务都需要等待这些任务执行完毕之后才能执行。也就是说，前者是后者的载体。<br>
异步任务：说实话，我不太理解。比较耗时的任务？不属于那种生命周期必须执行的任务（比如click）？</p>

<p>所以，当一个浏览器打开源代码给我看，我不太能指出哪些是同步任务，哪一些又是异步任务。</p>

<p>但我得到的收获是：javascript是单线程的，开浏览器的时候，会有一些默认每次都要执行的代码属于主任务，它们放在执行堆栈上，当它们执行完毕之后，主线程会去异步队列去找那一些准备好了的任务接着执行。前者执行完毕，循环的主要是后者那些异步队列里的任务了。<br>
</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="January  3, 2016  8:26 PM">2016年1月 3日 20:26</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-353700">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用just coding的这条留言" onclick="return CommentQuote(&#39;comment-quote-353700&#39;,&#39;just coding&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-354924" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">k</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-354924">
            <p>看得我肚子饿了</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 11, 2016  5:44 PM">2016年3月11日 17:44</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-354924">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用k的这条留言" onclick="return CommentQuote(&#39;comment-quote-354924&#39;,&#39;k&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-355636" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">a</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-355636">
            <p>这文章误导人啊</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April 13, 2016 10:03 PM">2016年4月13日 22:03</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-355636">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用a的这条留言" onclick="return CommentQuote(&#39;comment-quote-355636&#39;,&#39;a&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-359856" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://helloli.net" href="http://helloli.net/" target="_blank" rel="nofollow">LeeSir</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-359856">
            <blockquote>
<pre>引用简陋的以数据的发言：</pre>

<p>感觉文章的表述有些乱，比如“不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。”，这句让人理解的意思是“任务队列”主动通知“主线程”。而后面所表达的却是“主线程”在执行栈清空后才会到任务队列中取任务。前后主被动关系矛盾啊。</p>

<p>还有，“（2）主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。”。这时异步任务还在队列里没执行呢，怎么就会有了运行结果呢？</p>

<p>烦请阮老师在方便的时候不吝赐教。同时，感谢阮老师每次耐心细致的讲解和分享！</p>

</blockquote>

<p>第一个问题阮老师表述可能有问题，但是意思还是执行完js主线程的代码才会去看浏览器任务队列中的事件，再执行js代码中该事件对应的代码。<br>
第二个问题我的理解是，任务队列里放的是ajax这类的任务，是交给浏览器发起HTTP请求去执行的，当有了返回结果就会在任务队列中增加一个事件表示该ajax请求已经返回了结果，任务队列里的任务和js主线程是同时执行的。 不影响js是单线程的这个结论，只能说浏览器还会提供接口来供js实现异步操作。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="June 28, 2016 12:26 PM">2016年6月28日 12:26</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-359856">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用LeeSir的这条留言" onclick="return CommentQuote(&#39;comment-quote-359856&#39;,&#39;LeeSir&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-361164" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://sweetvvck.com" href="https://sweetvvck.com/" target="_blank" rel="nofollow">sweetvvck</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-361164">
            <blockquote>
<pre>引用青苔的发言：</pre>

<p>老师你好，请教个问题，如果是如图示Execution Context Stack所展示的那样，岂不是后来的Context先执行？<br>
那为何<br>
console.log('a');<br>
console.log('b');<br>
可以得到我们所要的执行顺序呢？</p>

</blockquote>

<p>Execution Context Stack 存放的是调用关系，你的例子的顺序是console.log('a'); 入栈直接运行后出栈，然后console.log('b');入栈，执行后出栈；<br>
如果例子是这样：</p>

<p>function log() {<br>
  console.log(arguments);<br>
}</p>

<p>log('a');</p>

<p>那么出入栈顺序是，log('a'); 入栈，console.log('a');入栈，执行console.log('a');出栈，log('a');出栈；<br>
如果觉得我说的不是很清楚，建议看看这个视频：http://vimeo.com/96425312</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="July 25, 2016  9:51 PM">2016年7月25日 21:51</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-361164">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用sweetvvck的这条留言" onclick="return CommentQuote(&#39;comment-quote-361164&#39;,&#39;sweetvvck&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-364356" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">helloworld</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-364356">
            <blockquote>
<pre>引用LeeSir的发言：</pre>

<p></p>

<p>第一个问题阮老师表述可能有问题，但是意思还是执行完js主线程的代码才会去看浏览器任务队列中的事件，再执行js代码中该事件对应的代码。<br>
第二个问题我的理解是，任务队列里放的是ajax这类的任务，是交给浏览器发起HTTP请求去执行的，当有了返回结果就会在任务队列中增加一个事件表示该ajax请求已经返回了结果，任务队列里的任务和js主线程是同时执行的。 不影响js是单线程的这个结论，只能说浏览器还会提供接口来供js实现异步操作。</p>

</blockquote>

<p>还是你解释的比较清楚。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="September 12, 2016  5:22 PM">2016年9月12日 17:22</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-364356">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用helloworld的这条留言" onclick="return CommentQuote(&#39;comment-quote-364356&#39;,&#39;helloworld&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-366541" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">winder</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-366541">
            <p>setImmediate(function (){<br>
  setImmediate(function A() {<br>
    console.log(1);<br>
    setImmediate(function B(){console.log(2);});<br>
  });</p>

<p>  setTimeout(function timeout() {<br>
    console.log('TIMEOUT FIRED');<br>
  }, 0);<br>
});</p>

<p>阮老师, 上面的例子, 在测试中也有下面的情况:<br>
TIMEOUT FIRED<br>
1<br>
2</p>

<p>我的node版本v5.11.0<br>
关于 setTimeout感觉它会在插队"任务队列"(时间点到了,就优先插队到任务队列队首)</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 18, 2016 10:55 AM">2016年10月18日 10:55</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-366541">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用winder的这条留言" onclick="return CommentQuote(&#39;comment-quote-366541&#39;,&#39;winder&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-366955" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">amber</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-366955">
            <p>发现我们培训老师讲的课应该是借鉴了阮老师的文章。。。有的原话都一样。。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="October 23, 2016  8:06 PM">2016年10月23日 20:06</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-366955">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用amber的这条留言" onclick="return CommentQuote(&#39;comment-quote-366955&#39;,&#39;amber&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-367791" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">叮当卡丁</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-367791">
            <p>“挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。”<br>
这句话我有一点不解，这个异步任务是要等所有同步任务都执行完毕了之后进入主线程呢？还是只要有IO设备返回结果就立马进入主线程，可以插队到已在主线程的同步任务前面？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November  4, 2016  5:32 PM">2016年11月 4日 17:32</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-367791">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用叮当卡丁的这条留言" onclick="return CommentQuote(&#39;comment-quote-367791&#39;,&#39;叮当卡丁&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-368157" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">Allen</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-368157">
            <p>自定义的回调函数会放到消息队列中吗？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 11, 2016 10:28 AM">2016年11月11日 10:28</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-368157">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Allen的这条留言" onclick="return CommentQuote(&#39;comment-quote-368157&#39;,&#39;Allen&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-369101" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://no" href="http://no/" target="_blank" rel="nofollow">Jim</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-369101">
            <p>关于setImmediate和setTimeout的执行顺序，确实是不定的：</p>

<p>setImmediate(function (){<br>
    setTimeout(function timeout() {<br>
    console.log('同一loop中的setTimeout方法执行，输出：TIMEOUT FIRED');<br>
  }, 0);<br>
  console.log('和 setTimeout、setImmediate 同一层次的代码执行');<br>
  setImmediate(function A() {<br>
**    console.log('同一loop中的setImmediate 方法执行， 输出：1' );<br>
    setImmediate(function B(){console.log('下一loop中的setImmediate 方法执行， 输出：2');});<br>
  });<br>
});</p>

<p>执行结果：<br>
和 setTimeout、setImmediate 同一层次的代码执行<br>
同一loop中的setTimeout方法执行，输出：TIMEOUT FIRED<br>
同一loop中的setImmediate 方法执行， 输出：1<br>
下一loop中的setImmediate 方法执行， 输出：2</p>

<p>如果注释掉标记为**的那行代码：<br>
setImmediate(function (){<br>
    setTimeout(function timeout() {<br>
    console.log('同一loop中的setTimeout方法执行，输出：TIMEOUT FIRED');<br>
  }, 0);<br>
//   console.log('和 setTimeout、setImmediate 同一层次的代码执行');<br>
  setImmediate(function A() {<br>
    console.log('同一loop中的setImmediate 方法执行， 输出：1' );<br>
    setImmediate(function B(){console.log('下一loop中的setImmediate 方法执行， 输出：2');});<br>
  });<br>
});<br>
执行结果：<br>
同一loop中的setImmediate 方法执行， 输出：1<br>
同一loop中的setTimeout方法执行，输出：TIMEOUT FIRED<br>
下一loop中的setImmediate 方法执行， 输出：2</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 24, 2016  3:50 PM">2016年11月24日 15:50</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-369101">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jim的这条留言" onclick="return CommentQuote(&#39;comment-quote-369101&#39;,&#39;Jim&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-369103" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://no" href="http://no/" target="_blank" rel="nofollow">Jim</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-369103">
            <p>上面的**标记错了，应该是上边那句console：</p>

<p>setImmediate(function (){<br>
    setTimeout(function timeout() {<br>
    console.log('同一loop中的setTimeout方法执行，输出：TIMEOUT FIRED');<br>
  }, 0);<br>
**   console.log('和 setTimeout、setImmediate 同一层次的代码执行');<br>
  setImmediate(function A() {<br>
    console.log('同一loop中的setImmediate 方法执行， 输出：1' );<br>
    setImmediate(function B(){console.log('下一loop中的setImmediate 方法执行， 输出：2');});<br>
  });<br>
});</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 24, 2016  3:52 PM">2016年11月24日 15:52</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-369103">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jim的这条留言" onclick="return CommentQuote(&#39;comment-quote-369103&#39;,&#39;Jim&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-369104" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://no" href="http://no/" target="_blank" rel="nofollow">Jim</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-369104">
            <p>文章写得很好，书也写得好！<br>
<a href="http://es6.ruanyifeng.com/#docs/async" rel="nofollow">http://es6.ruanyifeng.com/#docs/async</a></p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="November 24, 2016  3:57 PM">2016年11月24日 15:57</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-369104">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用Jim的这条留言" onclick="return CommentQuote(&#39;comment-quote-369104&#39;,&#39;Jim&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-371340" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://borninsummer.com/" href="http://borninsummer.com/" target="_blank" rel="nofollow">王子龙</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-371340">
            <p>setImmediate(function (){<br>
  setImmediate(function A() {<br>
    console.log('1');<br>
    setImmediate(function B(){console.log('2');});<br>
  });</p>

<p>  setTimeout(function timeout() {<br>
    console.log('3');<br>
  }, 0);<br>
});</p>

<p>上面这个代码的输出顺序实际上也是随机的。可能是 1，3，2；也可能是3，1，2.</p>

<p>在 I/O 操作的回调里，他们的顺序才不是随机的:</p>

<p>fs.readFile('../../README.md', () =&gt; {<br>
  setTimeout(() =&gt; {<br>
    console.log('1')<br>
  }, 0);</p>

<p>  setImmediate(() =&gt; {<br>
    console.log('2')<br>
  });<br>
});</p>

<p>总是先输出2， 再输出1. 文档提到的：<br>
The main advantage to using setImmediate() over setTimeout() is setImmediate() will always be executed before any timers if scheduled within an I/O cycle, independently of how many timers are present.<br>
—— <a href="https://github.com/nodejs/node/blob/master/doc/topics/event-loop-timers-and-nexttick.md" rel="nofollow">https://github.com/nodejs/node/blob/master/doc/topics/event-loop-timers-and-nexttick.md</a></p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 30, 2016  3:02 PM">2016年12月30日 15:02</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-371340">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用王子龙的这条留言" onclick="return CommentQuote(&#39;comment-quote-371340&#39;,&#39;王子龙&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-371343" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">losymear</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-371343">
            <p>呀 朴灵老师批注找不到了</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="December 30, 2016  4:37 PM">2016年12月30日 16:37</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-371343">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用losymear的这条留言" onclick="return CommentQuote(&#39;comment-quote-371343&#39;,&#39;losymear&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-371819" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">kevin</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-371819">
            <p>如果执行栈（主线程）在执行完正要loop任务队列前，主线程的代码又被触发执行了一次会怎么样？比如两次点击，是会先执行任务队列还是主线程的代码</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="January  9, 2017  2:56 PM">2017年1月 9日 14:56</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-371819">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用kevin的这条留言" onclick="return CommentQuote(&#39;comment-quote-371819&#39;,&#39;kevin&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-372051" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">和中堂</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-372051">
            <p>阮老师是一位不错的践行者，我前端典范。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="January 18, 2017  2:11 PM">2017年1月18日 14:11</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-372051">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用和中堂的这条留言" onclick="return CommentQuote(&#39;comment-quote-372051&#39;,&#39;和中堂&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-372482" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://github.com/goodyboy6" href="https://github.com/goodyboy6" target="_blank" rel="nofollow">goodyboy6</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-372482">
            <blockquote>
<pre>引用fans的发言：</pre>

<p>大神我有个问题，如何判断主线程结束，可以进入队列。什么时候能第二次进入主线程。</p>

</blockquote>
`event queue`中新增加event(比如点击) 和 `任务队列`中任务完成触发回调都会再次进入主线程。

        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="February  7, 2017 10:59 AM">2017年2月 7日 10:59</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-372482">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用goodyboy6的这条留言" onclick="return CommentQuote(&#39;comment-quote-372482&#39;,&#39;goodyboy6&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-372485" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://github.com/goodyboy6" href="https://github.com/goodyboy6" target="_blank" rel="nofollow">goodyboy6</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-372485">
            <p>根据MDN上官方的描述：<br>
&gt; The event loop got its name because of how it's usually implemented, which usually resembles:<br>
<br>
while (queue.waitForMessage()) {<br>
  queue.processNextMessage();<br>
}<br>
<br>
queue.waitForMessage waits synchronously for a message to arrive if there is none currently.</p>

<p>这篇文章中大量的关于主线程`主动获取任务事件结束回调`的描述是错误的。回调会让`queue.waitForMessage()`返回`true`，激活新的event loop，从而及时处理回调。</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="February  7, 2017 11:38 AM">2017年2月 7日 11:38</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-372485">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用goodyboy6的这条留言" onclick="return CommentQuote(&#39;comment-quote-372485&#39;,&#39;goodyboy6&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-373138" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://huangjihua.com.cn" href="http://huangjihua.com.cn/" target="_blank" rel="nofollow">hank</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-373138">
            <p>setImmediate(function (){<br>
  setImmediate(function A() {<br>
    console.log(1);<br>
    setImmediate(function B(){console.log(2);});<br>
  });</p>

<p>  setTimeout(function timeout() {<br>
    console.log('TIMEOUT FIRED');<br>
  }, 0);<br>
});<br>
// 1<br>
// TIMEOUT FIRED<br>
// 2</p>

<p>上面代码中，setImmediate和setTimeout被封装在一个setImmediate里面，它的运行结果总是1--TIMEOUT FIRED--2</p>

<p>阮老师，我测试的这个运行结果。也是不确定的，还有可能是TIMEOUT FIRED--1--2</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="February 19, 2017  5:43 PM">2017年2月19日 17:43</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-373138">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用hank的这条留言" onclick="return CommentQuote(&#39;comment-quote-373138&#39;,&#39;hank&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-373522" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">yyf</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-373522">
            <p>一直有一个疑问未能解开，Event Loop这个机制是不是由一个单独的（浏览器/node）线程控制，比如setTimeout(()=&gt;{}, 1000)方法，延迟1000ms，是谁来监控这1000ms后加入消息queue的，是浏览器的某个(事件处理)线程么？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="February 27, 2017 12:15 PM">2017年2月27日 12:15</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-373522">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用yyf的这条留言" onclick="return CommentQuote(&#39;comment-quote-373522&#39;,&#39;yyf&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-375073" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">杨守科</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-375073">
            <blockquote>
<pre>引用yyf的发言：</pre>

<p>一直有一个疑问未能解开，Event Loop这个机制是不是由一个单独的（浏览器/node）线程控制，比如setTimeout(()=&gt;{}, 1000)方法，延迟1000ms，是谁来监控这1000ms后加入消息queue的，是浏览器的某个(事件处理)线程么？</p>

</blockquote>

<p>对的 之前我也很疑惑 如果是单线程只能做一件事 执行到setTimeout 或ajax之后 把他们放入"事件池" 再去执行后续的代码 这个时候就会出现问题 说好的单线程只能做一件事的引擎怎么一边监控事件池的状态一边执行后续的代码呢？ 后来偶然看到一位大牛的博客翻译了一篇墙外的文章才突然顿悟（文章地址找不到了）。因为浏览器是多线程啊 当浏览器监控到"事件池"状态更新时会通知改变js引擎 这时候js引擎会在空闲的时候停下来去执行"事件池"里面的回调  所谓空闲的时候是指的是当前引擎执行的语句块上下文执行完毕时的正要执行下一个语句块时的状态  比如你在 setTimeout(()=&gt;{console.log(1000 end)}, 1000) 后面写个for的死循环 因为单线程 你永远也无法得到输出 或是在setTimeout后面写一个函数让其循环1300后它就会在1300后去回调输出而不是1000后</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 19, 2017  4:13 PM">2017年3月19日 16:13</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-375073">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用杨守科的这条留言" onclick="return CommentQuote(&#39;comment-quote-375073&#39;,&#39;杨守科&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-375630" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="http://www.mitianyi.com" href="http://www.mitianyi.com/" target="_blank" rel="nofollow">CRONWMMM</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-375630">
            <p>作为NodeJS的初学者，这是我看到过的最好的NodeJS事件循环机制的解析教程，终于弄懂了，谢谢老师！</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="March 29, 2017  1:40 PM">2017年3月29日 13:40</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-375630">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用CRONWMMM的这条留言" onclick="return CommentQuote(&#39;comment-quote-375630&#39;,&#39;CRONWMMM&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-376210" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">s</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-376210">
            <p>好像挺简单的, 为什么搞得好像很深奥的样子呢</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April 12, 2017  3:33 PM">2017年4月12日 15:33</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-376210">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用s的这条留言" onclick="return CommentQuote(&#39;comment-quote-376210&#39;,&#39;s&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-376488" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">tiny</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-376488">
            <p>文章中的这段话：但是，由于存在后文提到的"定时器"功能，主线程首先要检查一下执行时间，某些事件只有到了规定的时间，才能返回主线程。</p>

<p>引起了我很大的疑惑，请楼主参考一下<br>
<a href="http://ejohn.org/blog/how-javascript-timers-work/" rel="nofollow">http://ejohn.org/blog/how-javascript-timers-work/</a></p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April 21, 2017 11:10 AM">2017年4月21日 11:10</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-376488">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用tiny的这条留言" onclick="return CommentQuote(&#39;comment-quote-376488&#39;,&#39;tiny&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-376717" class="comment">
    <div class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author">哈哈</span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-376717">
            <p>真心搞不懂了。。回调那个对吗？</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="April 27, 2017  2:32 PM">2017年4月27日 14:32</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-376717">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用哈哈的这条留言" onclick="return CommentQuote(&#39;comment-quote-376717&#39;,&#39;哈哈&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    
        
        <div id="comment-377836" class="comment">
    <div id="comment-last" class="inner">
        <div class="comment-header">
            <div class="asset-meta">
<p>
                <span class="byline">
                    

                    <span class="vcard author"><a title="https://ruiming.me" href="https://ruiming.me/" target="_blank" rel="nofollow">瑞铭</a></span>

 说：
                </span>
</p>
            </div>
        </div>
        <div class="comment-content" id="comment-quote-377836">
            <p>&gt; 令人困惑的是，Node.js文档中称，setImmediate指定的回调函数，总是排在setTimeout前面。实际上，这种情况只发生在递归调用的时候。</p>

<p>实际上, 应该是只发生在异步 I/O 回调中. 这句话下面给的例子, 我在本地测试输出是有两种可能结果: TIMEOUT FIRED - 1 - 2 和 1 - TIMEOUT FIRED - 2.</p>

<p>如果是下面的例子</p>

<p>```js<br>
const fs = require('fs')<br>
fs.readdir(__dirname, () =&gt; {<br>
  setImmediate(() =&gt; console.log(1))<br>
  setTimeout(() =&gt; console.log(2), 0)<br>
})<br>
setImmediate(() =&gt; console.log('A'))<br>
setTimeout(() =&gt; console.log('A'), 0) // setTimeout 和 setImmediate 结果可对换, 因此都输出 A 就好<br>
```</p>

<p>上面例子结果只有两种可能, 一种是当异步回调在当前事件循环被执行时结果为 A 1 A 2. 一种是异步回调在下一个事件循环被执行, 结果是 A A 1 2. 1 永远先于 2 输出. 2 永远在最后输出. 屡试不爽.</p>
        </div>
<div class="comment-footer">
<div class="comment-footer-inner">
<p>
                   <abbr class="published" title="June 10, 2017  9:55 PM">2017年6月10日 21:55</abbr>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-377836">#</a>
 | <a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text" title="引用瑞铭的这条留言" onclick="return CommentQuote(&#39;comment-quote-377836&#39;,&#39;瑞铭&#39;);">引用</a>
</p>
</div>
</div>
    </div>
</div>
        
    </div>
        
    


    
    
    <div class="comments-open" id="comments-open">
        <h2 class="comments-open-header">我要发表看法</h2>
        <div class="comments-open-content">

        
            <div id="comment-greeting"></div>

            <form method="post" action="http://www.ruanyifeng.com/cgi-bin/mtos/mt-comments.cgi" name="comments_form" id="comments-form" onsubmit="return pleaseWait();">
                <input type="hidden" name="static" value="1">
                <input type="hidden" name="entry_id" value="1816">
                <input type="hidden" name="__lang" value="en">
                <input type="hidden" name="parent_id" value="" id="comment-parent-id">
                <input type="hidden" name="armor" value="1">
                <input type="hidden" name="preview" value="">
                <input type="hidden" name="sid" value="">
                <div id="comments-open-data">
            <div id="comments-open-text">
                    <p><label for="comment-text">您的留言
                    （HTML标签部分可用）</label></p>
                    <p><textarea id="comment-text" name="text" rows="10" cols="50"></textarea></p>
                </div>
                    <div id="comment-form-name">
                        <p><label for="comment-author">您的大名：</label></p>
                        <p><input id="comment-author" name="author" size="30" value="">  <span class="hint"> «-必填</span></p>
                    </div>
                    <div id="comment-form-email">
                        <p><label for="comment-email">电子邮件：</label></p>
                        <p><input id="comment-email" name="email" size="30" value="">  <span class="hint"> «-必填，不公开</span></p>
                    </div>
                    <div id="comment-form-url">
                        <p><label for="comment-url">个人网址：</label></p>
                        <p><input id="comment-url" name="url" size="30" value="">  <span class="hint"> «-我信任你，不会填写广告链接</span></p>
                    </div>
                    <div id="comment-form-remember-me">
                        <p>
                        <label for="comment-bake-cookie">记住个人信息？</label><input type="checkbox" id="comment-bake-cookie" name="bakecookie" onclick="!this.checked?forgetMe(document.comments_form):rememberMe(document.comments_form)" value="1" accesskey="r"></p>
                    </div>
                </div>
                    <div id="comment-form-reply" style="display:none">
                    <input type="checkbox" id="comment-reply" name="comment_reply" value="" onclick="mtSetCommentParentID()">
                    <label for="comment-reply" id="comment-reply-label"></label>
                </div>
                <div id="comments-open-captcha"></div>
                <div id="comments-open-footer">
<div id="wait" style="display:none;">
<p><strong>正在发表您的评论，请稍候</strong></p>
<p>
<input type="text" name="percent" size="3" style="font-family:Arial; color:black;text-align:center; border-width:medium; border-style:none;">           
<input type="text" name="chart" size="46" style="font-family:Arial;font-weight:bolder; color:black; padding:0px; border-style:none;">
</p>
</div>

                    <p><input type="submit" accesskey="s" name="post" id="comment-submit" value="发表">  <span class="hint"> «- 点击按钮</span></p>
                </div>
            </form>


        </div>
    </div>

    


</div>




                        </div>
                    </div>

                </div>
            </div>
        <script type="text/javascript" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/prism.js.下载"></script>

            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
<p><a href="http://www.ruanyifeng.com/contact.html">联系方式</a> | 2003 - 2017

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46829782-1', 'ruanyifeng.com');
  ga('send', 'pageview');

</script>



<!-- Site Meter -->
<a href="http://sm3.sitemeter.com/stats.asp?site=sm3bomoocom" target="_top">
<img src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/meter.asp.下载" alt="Site Meter" border="0"></a>

<!-- Copyright (c)2009 Site Meter -->

</p>

        </div>
    </div>
</div>


<div id="share_button_proto" style="display:none;">
<a class="bshareDiv" href="http://www.bshare.cn/share" style="display: block; text-decoration: none; padding: 0px; margin: 0px; font-size: 12px; height: 21px; width: 51px;"><div class="bsPromo bsPromo1"></div><div class="buzzButton bsStyle10" style="height:21px;color:#333;;background:transparent url(http://static.bshare.cn/frame/images/button_custom10-zh-Orange.gif) no-repeat;text-align:center;width:51px;"></div><div style="clear:both;"></div></a>



<script type="text/javascript" charset="utf-8" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/buttonLite.js.下载"></script>
<script type="text/javascript" charset="utf-8">
bShare.addEntry({
    title: document.getElementById("page-title").innerHTML,
url:window.location.href
});
</script>
</div>

<script>
document.getElementById("share_button").innerHTML=document.getElementById("share_button_proto").innerHTML;
</script>




        </div>
    </div>

<div id="bsBox" class="bsBox"><div class="bsClose">X</div><div class="bsTop"><div class="bsReturn">选择其他平台 &gt;&gt;</div><span style="margin-left:15px;">分享到</span><span class="bsPlatName"></span></div><div class="bsFrameDiv"><iframe class="bShareFrame" name="bsFrame645" frameborder="0" scrolling="no" allowtransparency="true" src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/saved_resource.html"></iframe></div><div id="bsMorePanel" style="display: none;"></div></div><div id="ads"></div><iframe src="./JavaScript 运行机制详解：再谈Event Loop - 阮一峰的网络日志_files/cm.html" style="display: none;"></iframe><div id="bsPanelHolder"><div id="bsPanel" style="display:none;"><div class="bsTitle"><a style="float:left;height:20px;line-height:20px;font-weight:bold;" class="bsSiteLink" target="_blank" href="http://www.bshare.cn/intro">分享到...</a><a class="bsSiteLink" style="cursor:pointer;float:right;height:20px;line-height:20px;font-weight:bold;" onclick="document.getElementById(&#39;bsPanel&#39;).style.display=&#39;none&#39;;">X</a><div class="bsClear"></div></div><div class="bsClear"></div><div style="padding-left:8px;background:#fff;*height:218px;"><div style="height:47px;border-bottom:1px #ccc solid;padding:4px 0 4px 16px;margin-right:8px;_padding-left:12px;"><div class="bsRlogo" onmouseover="javascript:this.className=&#39;bsRlogoSel&#39;" onmouseout="javascript:this.className=&#39;bsRlogo&#39;"><a href="javascript:;" onclick="javascript:bShare.share(event,&#39;facebook&#39;);return false;" style="text-decoration:none;line-height:120%;"><div style="cursor:pointer;width:24px;height:24px;margin:0 18px 2px;background:url(http://static.bshare.cn/frame/images//logos/m2/facebook.gif) no-repeat;"></div><div style="cursor:pointer;text-align:center;width:60px;height:16px !important;overflow:hidden;color:inherit;white-space:nowrap;line-height:120% !important;">Facebook</div></a></div><div class="bsRlogo" onmouseover="javascript:this.className=&#39;bsRlogoSel&#39;" onmouseout="javascript:this.className=&#39;bsRlogo&#39;"><a href="javascript:;" onclick="javascript:bShare.share(event,&#39;twitter&#39;);return false;" style="text-decoration:none;line-height:120%;"><div style="cursor:pointer;width:24px;height:24px;margin:0 18px 2px;background:url(http://static.bshare.cn/frame/images//logos/m2/twitter.gif) no-repeat;"></div><div style="cursor:pointer;text-align:center;width:60px;height:16px !important;overflow:hidden;color:inherit;white-space:nowrap;line-height:120% !important;">Twitter</div></a></div><div class="bsRlogo" onmouseover="javascript:this.className=&#39;bsRlogoSel&#39;" onmouseout="javascript:this.className=&#39;bsRlogo&#39;"><a href="javascript:;" onclick="javascript:bShare.share(event,&#39;sinaminiblog&#39;);return false;" style="text-decoration:none;line-height:120%;"><div style="cursor:pointer;width:24px;height:24px;margin:0 18px 2px;background:url(http://static.bshare.cn/frame/images//logos/m2/sinaminiblog.gif) no-repeat;"></div><div style="cursor:pointer;text-align:center;width:60px;height:16px !important;overflow:hidden;color:inherit;white-space:nowrap;line-height:120% !important;">新浪微博</div></a></div></div><div class="bsLogoLink"><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="微信" onclick="javascript:bShare.share(event,&#39;weixin&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//logos/s4/weixin.png) no-repeat;">微信</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="腾讯微博" onclick="javascript:bShare.share(event,&#39;qqmb&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -1512px;">腾讯微博</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="豆瓣网" onclick="javascript:bShare.share(event,&#39;douban&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -540px;">豆瓣网</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="饭否" onclick="javascript:bShare.share(event,&#39;fanfou&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -666px;">饭否</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="雪球" onclick="javascript:bShare.share(event,&#39;xueqiu&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//logos/s4/xueqiu.png) no-repeat;">雪球</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="电子邮件" onclick="javascript:bShare.share(event,&#39;email&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -612px;">电子邮件</a></div></div><div class="bsLogoLink"><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="Google+" onclick="javascript:bShare.share(event,&#39;gplus&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//logos/s4/gplus.png) no-repeat;">Google+</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="QQ空间" onclick="javascript:bShare.share(event,&#39;qzone&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -1566px;">QQ空间</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="QQ好友" onclick="javascript:bShare.share(event,&#39;qqim&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//logos/s4/qqim.png) no-repeat;">QQ好友</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="Instapaper" onclick="javascript:bShare.share(event,&#39;instapaper&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -954px;">Instapaper</a></div><div class="bsLogo" onmouseover="javascript:this.className=&#39;bsLogoSel&#39;" onmouseout="javascript:this.className=&#39;bsLogo&#39;"><a href="javascript:;" title="美味书签" onclick="javascript:bShare.share(event,&#39;delicious&#39;);return false;" style="background:url(http://static.bshare.cn/frame/images//slogos_sprite8.png) no-repeat 0 -432px;">美味书签</a></div></div><div class="bsClear"></div></div><div style="height:20px;line-height:20px;padding:0 8px;border-top:1px solid #e8e8e8;color:#666;background:#f2f2f2;"><div class="buzzButton" style="float:left;">更多平台... <font style="font-weight:normal;">(133)</font></div><div id="bsPower" style="float:right;text-align:right;overflow:hidden;height:100%;"><a class="bsSiteLink" style="font-size:10px;vertical-align:text-bottom;line-height:24px;cursor:pointer;" href="http://www.bshare.cn/" target="_blank"><span style="font-size:10px;vertical-align:text-bottom;"><span style="color:#f60;">b</span>Share</span></a></div></div></div></div></body></html>